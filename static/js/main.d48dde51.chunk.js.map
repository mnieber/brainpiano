{"version":3,"sources":["quiz/components/QuizFrame.tsx","../../../npm/react-default-props-context/dist/NestedDefaultPropsProvider.js","../../../npm/react-default-props-context/dist/CtrProvider.js","../../../npm/react-default-props-context/dist/useDefaultProps.js","utils/mathMod.ts","voicings/noteConstants.ts","keyboard/keyConstants.ts","quiz/utils/voicingTitleFromQuery.ts","voicings/components/VoicingTitle.tsx","groups/components/GroupsFrameTopPanel.tsx","groups/components/GroupsFrame.tsx","utils/components/ValuePicker.tsx","groups/components/GroupPicker.tsx","groups/components/GroupsFrameLeftPanel.tsx","utils/RST.ts","utils/components/Effect.tsx","utils/components/ResourceView.tsx","voicings/utils/playChord.ts","voicings/components/InversionSelector.tsx","keyboard/components/ClefModulationSelector.tsx","keyboard/components/ClefSelector.tsx","keyboard/noteColours.ts","keyboard/components/Marker.tsx","keyboard/components/Key.tsx","keyboard/components/Octave.tsx","keyboard/utils/noteValueToColour.ts","voicings/components/RandomChordSelector.tsx","keyboard/components/Keyboard.tsx","keyboard/components/ClefListView.tsx","keyboard/components/ClefListViewItem.tsx","voicings/parse.ts","io/components/IoMenu.tsx","quiz/components/QuizFrameTopPanel.tsx","quiz/components/QuizView.tsx","../../../npm/aspiration/dist/internal/symbols.js","../../../npm/aspiration/dist/internal/utils.js","../../../npm/aspiration/dist/index.js","../../../npm/skandha/dist/internal/symbols.js","../../../npm/skandha/dist/internal/utils.js","../../../npm/skandha/dist/lib/data.js","../../../npm/skandha/dist/lib/ctr.js","../../../npm/skandha/dist/internal/options.js","../../../npm/skandha/dist/internal/logging.js","../../../npm/skandha/dist/lib/facet.js","../../../npm/skandha/dist/lib/patch.js","../../../npm/skandha/dist/lib/operation.js","../../../npm/skandha/dist/lib/install.js","../../../npm/skandha-mobx/dist/internal/symbols.js","../../../npm/skandha-mobx/dist/internal/utils.js","../../../npm/skandha-mobx/dist/lib/makeCtrObservable.js","utils/ids.ts","../../../npm/skandha-facets/dist/Selection.js","../../../npm/skandha-facets/dist/internal/utils.js","../../../npm/skandha-facets/dist/Highlight.js","../../../npm/skandha-facets/dist/Filtering.js","../../../npm/skandha-facets/dist/lib/getPreview.js","../../../npm/skandha-facets/dist/Insertion.js","../../../npm/skandha-facets/dist/policies/highlightFollowsSelection.js","../../../npm/skandha-facets/dist/Addition.js","../../../npm/skandha-facets/dist/Editing.js","utils/random.ts","voicings/utils/invertChord.ts","voicings/utils/voicingToChord.ts","quiz/utils/createQuery.ts","quiz/QuizState/facets/Inputs.ts","quiz/QuizState/facets/Outputs.ts","quiz/QuizState/index.ts","quiz/QuizState/policies/selectClefBasedOnPreselection.ts","voicings/voicingGroups.ts","quiz/components/QuizStateProvider.tsx","app/components/UrlRouter.tsx","app/components/App.tsx","groups/GroupsStore.ts","keyboard/PreselectionStore.ts","voicings/VoicingStore.ts","keyboard/ClefStore.ts","app/components/StoreProvider.tsx","app/AppStore.ts","app/policies/voicingStoreUsesSelectedClef.ts","app/components/useStore.ts","reportWebVitals.ts","index.tsx"],"names":["QuizFrame","observer","props","className","classnames","children","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","DefaultPropsContext","React","useDefaultPropsContext","NestedDefaultPropsProvider","defaultProps","value","Provider","ctrByKey","CtrProvider","ctr","_a","ctrKey","createCtr","cleanUpFunction","updateCtr","undefined","destroyCtr","getDefaultProps","useDefaultProps","console","error","Proxy","get","obj","prop","mathMod","m","isInteger","NaN","noteNameByValue","valueByNoteName","root","flat9","nine","ninth","flat3","third","fourth","eleven","eleventh","sharp4","flat5","sharp11","fifth","flat6","flat13","six","sixth","thirteen","thirteenth","flat7","seven","seventh","clefs","clefOffsets","clefLetters","whiteKeyIndexes","blackKeyIndexes","isWhiteKeyIndex","keyIndex","includes","octaveRootNoteValue","octaveIndex","noteValueToIndex","noteValue","voicingTitleFromQuery","query","noteIndex","inversion","voicing","chord","startNoteIdx","startNoteName","clef","name","VoicingTitle","label","GroupsFrameTopPanel","ValuePicker","isMulti","isCreatable","pickableValue","pickableValues","labelFromValue","others","toPickerValue","pickableVal","__isNew__","options","map","pickerProps","isNil","onKeyDown","e","picker","style","zIndex","GroupPicker","onChange","action","values","groupsSelection","ids","x","id","groups","items","GroupsFrameLeftPanel","RESET","f","useDeepCompareEffect","Fragment","UPDATING","ERRORED","UPDATED","loadingRS","type","updating_state","defaultRenderErrored","rsMap","update","then","getErrorMsg","result","catch","message","defaultRenderUpdating","renderErrored","renderUpdating","rs","renderUpdated","tryRenderUpdated","isErroredRS","isUpdatingRS","isResetRS","Error","catchAll","context","window","AudioContext","webkitAudioContext","synth","AudioSynth","InversionSelector","voicingStore","useStore","handleKeys","onKeyEvent","key","setInversion","quizState","forEach","note","playNote","ClefModulationSelector","preselectionStore","handleEventType","setIsSharpening","setIsFlattening","reset","ClefSelector","setClefLetter","noteColours","0","1","2","3","4","5","6","7","8","9","10","11","Marker","nrOfStripes","Math","floor","height","isStriped","flow","always","range","stripeIdx","nrBg","nrFilled","isFilled","y","fill","backgroundColour","width","strokeWidth","opacity","whiteKeyProps","markerHeight","blackKeyProps","whiteKeyX","fraction","blackKeyX","Key","isWhiteKey","index","keyProps","markerOffsetY","keyIndexes","indexOf","getKeyX","stroke","markerColour","markerIsStriped","Octave","concat","keys","add","harmonicColour","endsWith","colour","split","noteValueToColour","RandomChordSelector","pickRandomChord","Keyboard","clefStore","octaves","onClick","tabIndex","ClefListView","clefDivs","clefsSelection","onMouseDown","selectItem","itemId","isShift","isCtrl","noItems","ClefListViewItem","parseVoicing","data","log","parseVoicingGroup","voicings","cache","parseVoicingGroups","IoMenu","onSelect","eventKey","navigator","clipboard","writeText","JSON","stringify","open","readText","clipText","setGroups","parse","autoOpen","pullRight","Toggle","btnSize","btnStyle","Menu","divider","QuizFrameTopPanel","HelpButton","nextQuery","QuizView","useMemo","symbols","admin","Symbol","getAdmin","host","fn","STRIP_COMMENTS","ARGUMENT_NAMES","getParamNames","func","fnStr","toString","replace","slice","match","_setDefaultCallbacks","hostObjectAdmin","propertyName","defaultCbs","defaultCallbackMap","_host","target","descriptor","createDefaultCbs","_b","_c","_d","_e","args","_i","callbacks","callbackMap","paramNamesMap","paramNames","paramsMemo","idx","paramName","enter","returnValue","bind","exit","wrapped","setCallbacks","cbs","Cbs","nop","maybe","getOrCreate","getCtrClassAdmin","ctrClass","getCtrAdmin","getFacetClassAdmin","facetClass","getFacetAdmin","facet","dataHost","dataMember","facetClassAdmin","constructor","dataMembers","loggedMembers","getDataMemberNames","input","output","getc","parentContainer","getFacetMemberNames","facetMembers","cleanUpCtr","ctrAdmin","cleanUpFunctions","logging","formatObject","facetLogName","logName","_defaultFacetLogName","operationMember","start","getCtrState","ctrStateOverride","ctrState","getState","facetState","operationName","string","toLowerCase","toUpperCase","opName","group","groupEnd","getLoggedMemberNames","reduce","acc","loggedMember","facetMemberName","facetHost","facetMember","ctrClassAdmin","push","registerFacets","ctrName","facetByFacetClassName","members","getOwnPropertyNames","member","setCtr","getf","getm","classMember","facetClassName","patchFacet","dataMemberNames","warnIfNotADataMember","defineProperty","enumerable","configurable","mapDataToFacet","getter","transform","toFacetClass","toMember","toCtr","patch","toClassMember","mapDatasToFacet","getters","datas","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","__generator","body","g","_","sent","trys","ops","verb","iterator","v","op","TypeError","pop","_operation","punctualOptions","operationMemberNames","async","isLogging","operation","installPolicies","policies","policy","makeCtrObservable","facetName","makeFacetObservable","effects","makeObservable","addActionsToFacet","observableMembers","dataMemberName","isObservableProp","isComputedProp","getOwnPropertyDescriptor","computed","observable","getOperationMemberNames","getIds","__decorate","decorators","desc","d","c","r","Reflect","decorate","Selection","writable","selectionParams","handleSelectItem","hasItem","selectableIds","startItemId","anchorId","startIdx","stopIdx","idxRange","stop","ans","min","max","filter","selection","selectionUsesSelectableIds","Highlight","scrollItemIntoView","highlightUsesItemLookUpTable","getItemById","itemById","Filtering","isEnabled","inputItems","setEnabled","flag","topOfTheList","getPreview","targetItemId","isBefore","payload","maybeTargetItemId","item","find","Insertion","drag","preview","insertItems","highlightFollowsSelection","highlightItem","Addition","storeLocation","createItem","highlightNewItem","confirm","_reset","restoreLocation","parentId","Editing","saveItem","isEditing","refreshView","randomElement","random","size","invertChord","pos","times","constant","arr","maxNote","first","take","last","takeRight","minNote","abs","getInversionRange","minInversion","maxInversion","l","voicingToChord","rootNoteValue","keyOffset","createQuery","nrVoicings","sumBy","voicingIdx","groupIdx","count","L","inversionRange","inversions","getRandomInversion","Inputs","Outputs","qsList","listToItemById","groupsDisplay","QuizState","highlight","_setClefsCallbacks","_applyClefsPolicies","_setGroupsCallbacks","_applyGroupsPolicies","cuf","handler","event","topic","details","clefLetter","isSharpening","isFlattening","setClef","signal","remove","Policies","addCleanUpFunctionToCtr","FacetPolicies","Outputs_display","Facets","Outputs_itemById","inputs","setVoicing","voicingGroups","QuizStateProvider","groupsStore","createState","state","setClefs","reaction","fireImmediately","destroy","outputs","clefsDisplay","clefsHighlight","groupsHighlight","history","createBrowserHistory","UrlRouter","path","App","GroupsStore","PreselectionStore","Signal","dispatch","cScale","VoicingStore","clamp","nrOfVoices","ClefStore","clefSharp","clefFlat","setClefSharp","setClefFlat","modulate","appStore","applyPolicies","StoreContext","createContext","store","useContext","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d48dde51.chunk.js","sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react-lite';\n\nimport { QuizFrameTopPanel } from 'src/quiz/components';\n\nimport './QuizFrame.scss';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\nexport const QuizFrame: React.FC<PropsT> = observer((props: PropsT) => {\n  return (\n    <div\n      className={classnames('QuizFrame flex flex-col')}\n    >\n      <QuizFrameTopPanel/>\n      <div\n        className={classnames('QuizFrame__MidSection flex flex-row')}\n      >\n        \n        {props.children}\n        \n      </div>\n      \n    </div>\n  );\n});","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from \"react\";\nexport var DefaultPropsContext = React.createContext({});\nexport var useDefaultPropsContext = function () {\n    return React.useContext(DefaultPropsContext);\n};\nexport var NestedDefaultPropsProvider = function (props) {\n    var defaultProps = useDefaultPropsContext();\n    var value = __assign(__assign({}, (defaultProps || {})), props.value);\n    return (React.createElement(DefaultPropsContext.Provider, { value: value }, props.children));\n};\n","import * as React from \"react\";\nimport { NestedDefaultPropsProvider } from \"./NestedDefaultPropsProvider\";\nvar ctrByKey = {};\nexport var CtrProvider = function (props) {\n    var ctr = React.useState(function () {\n        var _a;\n        return props.ctrKey\n            ? (ctrByKey[props.ctrKey] = (_a = ctrByKey[props.ctrKey]) !== null && _a !== void 0 ? _a : props.createCtr())\n            : props.createCtr();\n    })[0];\n    React.useEffect(function () {\n        var cleanUpFunction = props.updateCtr ? props.updateCtr(ctr) : undefined;\n        var unmount = function () {\n            if (cleanUpFunction)\n                cleanUpFunction();\n            if (!props.ctrKey)\n                props.destroyCtr(ctr);\n        };\n        return unmount;\n    });\n    return (React.createElement(NestedDefaultPropsProvider, { value: props.getDefaultProps(ctr) }, props.children));\n};\n","import { useDefaultPropsContext } from \"./NestedDefaultPropsProvider\";\nexport var useDefaultProps = function (props) {\n    var defaultProps = useDefaultPropsContext();\n    if (!defaultProps) {\n        console.error(\"No default props: \", props);\n    }\n    return new Proxy(props, {\n        get: function (obj, prop) {\n            if (prop in obj) {\n                return obj[prop];\n            }\n            if (prop in defaultProps) {\n                return defaultProps[prop]();\n            }\n            else {\n                return undefined;\n            }\n        },\n    });\n};\n","import { isInteger } from 'lodash/fp';\n\nexport const mathMod = (m: number, p: number) => {\n  if (!isInteger(m)) {\n    return NaN;\n  }\n  if (!isInteger(p) || p < 1) {\n    return NaN;\n  }\n  return ((m % p) + p) % p;\n};\n","export const root = 0;\nexport const flat9 = 1;\nexport const ninth = 2;\nexport const sharp9 = 3;\nexport const flat3 = 3;\nexport const third = 4;\nexport const fourth = 5;\nexport const eleventh = 5;\nexport const sharp4 = 6;\nexport const sharp11 = 6;\nexport const flat5 = 6;\nexport const fifth = 7;\nexport const sharp5 = 8;\nexport const flat6 = 8;\nexport const flat13 = 8;\nexport const sixth = 9;\nexport const thirteenth = 9;\nexport const flat7 = 10;\nexport const seventh = 11;\n\nexport const noteNameByValue = {\n  '0': 'root',\n  '1': 'flat nine',\n  '2': 'nine',\n  '3': 'flat third',\n  '4': 'third',\n  '5': 'fourth/eleventh',\n  '6': 'tritone',\n  '7': 'fifth',\n  '8': 'flat thirteen',\n  '9': 'thirteenth',\n  '10': 'flat seven',\n  '11': 'seven',\n};\n\nexport const valueByNoteName = {\n  root: 0,\n  'flat nine': 1,\n  flat9: 1,\n  nine: 2,\n  ninth: 2,\n  'flat third': 3,\n  flat3: 3,\n  third: 4,\n  fourth: 5,\n  eleven: 5,\n  eleventh: 5,\n  sharp4: 6,\n  flat5: 6,\n  sharp11: 6,\n  'sharp fourth': 6,\n  'sharp eleventh': 6,\n  fifth: 7,\n  'flat thirteen': 8,\n  flat6: 8,\n  flat13: 8,\n  six: 9,\n  sixth: 9,\n  thirteen: 9,\n  thirteenth: 9,\n  flat7: 10,\n  'flat seven': 10,\n  seven: 11,\n  seventh: 11,\n};\n","import { includes } from 'lodash/fp';\nimport { mathMod } from 'src/utils/mathMod';\n\nexport const clefC = 'C';\nexport const clefCSharp = 'C#';\nexport const clefCFlat = 'Cb';\nexport const clefD = 'D';\nexport const clefDSharp = 'D#';\nexport const clefDFlat = 'Db';\nexport const clefE = 'E';\nexport const clefESharp = 'E#';\nexport const clefEFlat = 'Eb';\nexport const clefF = 'F';\nexport const clefFSharp = 'F#';\nexport const clefFFlat = 'Fb';\nexport const clefG = 'G';\nexport const clefGSharp = 'G#';\nexport const clefGFlat = 'Gb';\nexport const clefA = 'A';\nexport const clefASharp = 'A#';\nexport const clefAFlat = 'Ab';\nexport const clefB = 'B';\nexport const clefBSharp = 'B#';\nexport const clefBFlat = 'Bb';\n\nexport const clefs = [\n  'C',\n  'C#',\n  'D',\n  'Eb',\n  'E',\n  'F',\n  'F#',\n  'G',\n  'Ab',\n  'A',\n  'Bb',\n  'B',\n];\n\nexport const clefOffsets: { [key: string]: number } = {\n  [clefCFlat]: 11,\n  [clefC]: 0,\n  [clefCSharp]: 1,\n  [clefDFlat]: 1,\n  [clefD]: 2,\n  [clefDSharp]: 3,\n  [clefEFlat]: 3,\n  [clefE]: 4,\n  [clefESharp]: 5,\n  [clefFFlat]: 4,\n  [clefF]: 5,\n  [clefFSharp]: 6,\n  [clefGFlat]: 6,\n  [clefG]: 7,\n  [clefGSharp]: 8,\n  [clefAFlat]: 8,\n  [clefA]: 9,\n  [clefASharp]: 10,\n  [clefBFlat]: 10,\n  [clefB]: 11,\n  [clefBSharp]: 0,\n};\n\nexport const clefLetters = [clefC, clefD, clefE, clefF, clefG, clefA, clefB];\n\nexport const whiteKeyIndexes = [0, 2, 4, 5, 7, 9, 11];\nexport const blackKeyIndexes = [1, 3, 6, 8, 10];\n\nexport const isWhiteKeyIndex = (keyIndex: number) =>\n  includes(keyIndex, whiteKeyIndexes);\n\nexport const nrOfNotesInOctave = 12;\nexport const octaveRootNoteValue = (octaveIndex: number) =>\n  octaveIndex * nrOfNotesInOctave;\nexport const noteValueToIndex = (noteValue: number) =>\n  mathMod(noteValue, nrOfNotesInOctave);\n","import { QueryT } from 'src/quiz/types';\nimport { mathMod } from 'src/utils/mathMod';\nimport { noteNameByValue } from 'src/voicings/noteConstants';\nimport { noteValueToIndex, clefOffsets } from 'src/keyboard/keyConstants';\n\nexport const voicingTitleFromQuery = (query: QueryT) => {\n  const noteIndex = mathMod(query.inversion, query.voicing.chord.length);\n  const startNoteIdx = noteValueToIndex(query.voicing.chord[noteIndex]);\n  const startNoteName = (noteNameByValue as any)[startNoteIdx];\n\n  return `${query.clef} ${query.voicing.name} from ` + `${startNoteName}`;\n};\n","import { observer } from 'mobx-react-lite';\nimport 'src/keyboard/components/Keyboard.css';\nimport { voicingTitleFromQuery } from 'src/quiz/utils/voicingTitleFromQuery';\nimport { QueryT } from 'src/quiz/types';\n\nimport './VoicingTitle.scss';\n\ntype PropsT = {\n  query?: QueryT;\n  label?: string;\n};\n\nexport const VoicingTitle = observer((props: PropsT) => {\n  return (\n    <div className=\"VoicingTitle\">\n      {(props.label ?? '') +\n        (props.query ? voicingTitleFromQuery(props.query) : '')}\n    </div>\n  );\n});\n","import React from 'react';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react-lite';\n\nimport './GroupsFrameTopPanel.scss';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\nexport const GroupsFrameTopPanel: React.FC<PropsT> = observer(() => {\n  return (\n    <div\n      className={classnames('GroupsFrameTopPanel')}\n    >\n    </div>\n  );\n});","import React from 'react';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react-lite';\n\nimport { GroupsFrameTopPanel } from 'src/groups/components';\nimport { GroupsFrameLeftPanel } from 'src/groups/components';\n\nimport './GroupsFrame.scss';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\nexport const GroupsFrame: React.FC<PropsT> = observer((props: PropsT) => {\n  return (\n    <div\n      className={classnames('GroupsFrame flex flex-col')}\n    >\n      <GroupsFrameTopPanel/>\n      <div\n        className={classnames('GroupsFrame__MidSection flex flex-row')}\n      >\n        <GroupsFrameLeftPanel/>\n        {props.children}\n        \n      </div>\n      \n    </div>\n  );\n});","import Select from 'react-select';\nimport CreatableSelect from 'react-select/creatable';\nimport { isNil } from 'lodash/fp';\nimport { observer } from 'mobx-react-lite';\n\nexport interface PickerValueT {\n  value: any;\n  label: string;\n  __isNew__?: boolean;\n}\n\ntype PropsT<ValueT> = {\n  isMulti: boolean;\n  isCreatable: boolean;\n  pickableValues: ValueT[];\n  pickableValue: ValueT;\n  labelFromValue: (value: any) => string;\n  [k: string]: any;\n};\n\nexport const ValuePicker = observer(\n  <ValueT, ConcretePropsT extends PropsT<ValueT>>(\n    props: ConcretePropsT\n  ): JSX.Element => {\n    const {\n      isMulti,\n      isCreatable,\n      pickableValue,\n      pickableValues,\n      labelFromValue,\n      ...others\n    } = props;\n\n    const toPickerValue = (pickableVal: any) => {\n      return pickableVal.__isNew__\n        ? pickableVal\n        : {\n            value: pickableVal,\n            label: labelFromValue(pickableVal),\n          };\n    };\n\n    const options = pickableValues.map(toPickerValue);\n\n    const pickerProps = {\n      isMulti: isMulti,\n      options,\n      value: isNil(pickableValue)\n        ? undefined\n        : isMulti\n        ? (pickableValue as any).map(toPickerValue)\n        : toPickerValue(pickableValue),\n      onKeyDown: (e: any) => {\n        if (others.onKeyDown) {\n          others.onKeyDown(e);\n        }\n      },\n      ...others,\n    };\n\n    const picker = isCreatable ? (\n      <CreatableSelect {...pickerProps} />\n    ) : (\n      <Select {...pickerProps} />\n    );\n\n    return <div style={{ zIndex: others.zIndex }}>{picker}</div>;\n  }\n);\n","import classnames from 'classnames';\nimport { action } from 'mobx';\nimport { observer } from 'mobx-react-lite';\nimport { useDefaultProps, FC } from 'react-default-props-context';\nimport { Selection } from 'skandha-facets/Selection';\n\nimport { PickerValueT, ValuePicker } from 'src/utils/components/ValuePicker';\nimport { GroupT } from 'src/groups/types';\n\nimport './GroupPicker.scss';\n\ntype PropsT = {\n  className?: any;\n};\n\ntype DefaultPropsT = {\n  groups: GroupT[];\n  groupsSelection: Selection;\n};\n\nexport const GroupPicker: FC<PropsT, DefaultPropsT> = observer((p: PropsT) => {\n  const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n\n  const onChange = action((value: PickerValueT) => {\n    const values: Array<any> = (value as any) ?? [];\n    props.groupsSelection.ids = values.map((x) => x.value.id);\n  });\n\n  return (\n    <div className={classnames('GroupPicker', props.className)}>\n      <ValuePicker\n        isMulti={true}\n        isCreatable={false}\n        pickableValues={props.groups}\n        labelFromValue={(x: any) => x.name}\n        pickableValue={props.groupsSelection.items}\n        onChange={onChange}\n      />\n    </div>\n  );\n});\n","import React from 'react';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react-lite';\n\nimport './GroupsFrameLeftPanel.scss';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\nexport const GroupsFrameLeftPanel: React.FC<PropsT> = observer(() => {\n  return (\n    <div\n      className={classnames('GroupsFrameLeftPanel')}\n    >\n    </div>\n  );\n});","import { action } from \"mobx\";\n\nconst RESET = \"RESET\";\nconst UPDATING = \"UPDATING\";\nconst ERRORED = \"ERRORED\";\nconst UPDATED = \"UPDATED\";\nconst LOADING = \"LOADING\";\n\nexport type ResetRST = {\n  type: typeof RESET;\n};\n\nexport const resetRS = (): ResetRST => ({ type: RESET });\n\nexport const isResetRS = <UpdatingT>(rs: RST<UpdatingT>): rs is ResetRST =>\n  rs.type === RESET;\n\nexport type UpdatingRST<UpdatingT> = {\n  type: typeof UPDATING;\n  updating_state: UpdatingT;\n};\n\nexport const updatingRS = <UpdatingT>(\n  updating_state: UpdatingT\n): UpdatingRST<UpdatingT> => ({\n  type: UPDATING,\n  updating_state,\n});\n\nexport const isUpdatingRS = <UpdatingT>(\n  rs: RST<UpdatingT>\n): rs is UpdatingRST<UpdatingT> => rs.type === UPDATING;\n\nexport type ErroredRST = {\n  type: typeof ERRORED;\n  message: string;\n};\n\nexport const erroredRS = (message: string): ErroredRST => ({\n  type: ERRORED,\n  message,\n});\n\nexport const isErroredRS = <UpdatingT>(rs: RST<UpdatingT>): rs is ErroredRST =>\n  rs.type === ERRORED;\n\nexport type UpdatedRST = {\n  type: typeof UPDATED;\n};\n\nexport const updatedRS = (): UpdatedRST => ({\n  type: UPDATED,\n});\n\nexport const isUpdatedRS = <UpdatingT>(rs: RST<UpdatingT>): rs is UpdatedRST =>\n  rs.type === UPDATED;\n\nexport type LoadingT = {\n  type: typeof LOADING;\n};\n\nexport const loadingRS = (): UpdatingRST<LoadingT> =>\n  updatingRS({\n    type: LOADING,\n  });\n\nexport type RST<UpdatingT = LoadingT> =\n  | ResetRST\n  | UpdatingRST<UpdatingT>\n  | ErroredRST\n  | UpdatedRST;\n\nexport const updateRes = action(\n  (\n    rsMap: { [k: string]: any },\n    id: string,\n    update: Function,\n    then: Function,\n    getErrorMsg?: Function\n  ) => {\n    rsMap[id] = loadingRS();\n    return update()\n      .then(\n        action((result: any) => {\n          then(result);\n          rsMap[id] = updatedRS();\n        })\n      )\n      .catch(\n        action((e: any) => {\n          rsMap[id] = erroredRS(\n            getErrorMsg ? getErrorMsg(e) : `Could not load ${id}`\n          );\n        })\n      );\n  }\n);\n","import React from 'react';\nimport { observer } from 'mobx-react-lite';\nimport useDeepCompareEffect from 'use-deep-compare-effect';\n\ntype EffectWithoutArgsPropsT = {\n  f: () => void;\n};\n\nexport const EffectWithoutArgs: (\n  props: EffectWithoutArgsPropsT\n) => React.ReactElement = observer(({ f }) => {\n  useDeepCompareEffect(() => {\n    const cleanUpFunction = f();\n    return cleanUpFunction;\n  }, [f]);\n  return <React.Fragment />;\n});\n","import React from 'react';\nimport { observer } from 'mobx-react-lite';\n\nimport {\n  RST,\n  isResetRS,\n  isUpdatingRS,\n  isUpdatedRS,\n  isErroredRS,\n} from 'src/utils/RST';\n\ntype PropsT<UpdatingT> = {\n  rs: RST<UpdatingT>;\n  renderUpdated: () => JSX.Element;\n  renderUpdating?: (updating_state: UpdatingT) => JSX.Element;\n  renderErrored?: (message: string) => JSX.Element;\n};\n\n// TODO better default renders\nconst defaultRenderErrored = (message: string) => {\n  return <div>Error{message !== undefined && `: ${message}`}</div>;\n};\nconst defaultRenderUpdating = () => {\n  return <div>Loading...</div>;\n};\n\nexport const ResourceView = observer(\n  <UpdatingT,>(props: PropsT<UpdatingT>): JSX.Element => {\n    const renderErrored = props.renderErrored ?? defaultRenderErrored;\n    const renderUpdating = props.renderUpdating ?? defaultRenderUpdating;\n\n    const tryRenderUpdated = () => {\n      try {\n        const result = props.renderUpdated();\n        return result;\n      } catch (e) {\n        return renderErrored(e.message);\n      }\n    };\n\n    const catchAll = () => {\n      throw Error(`Received unrecognized resource state ${props.rs}`);\n    };\n\n    const renderReset = () => {\n      return <React.Fragment />;\n    };\n\n    return isUpdatedRS(props.rs)\n      ? tryRenderUpdated()\n      : isErroredRS(props.rs)\n      ? renderErrored(props.rs.message)\n      : isUpdatingRS(props.rs)\n      ? renderUpdating(props.rs.updating_state)\n      : isResetRS(props.rs)\n      ? renderReset()\n      : catchAll();\n  }\n);\n","import { ChordT } from 'src/voicings/types';\nimport { ClefT } from 'src/keyboard/types';\nimport AudioSynth from 'audiosynth';\nimport { forEach } from 'lodash/fp';\nimport { clefOffsets } from 'src/keyboard/keyConstants';\n\nvar AudioContext = window.AudioContext || (window as any).webkitAudioContext;\n\nvar context = new AudioContext();\nvar synth = new AudioSynth(context);\n\nexport const playChord = (chord: ChordT, clef: ClefT) => {\n  forEach((note) => synth.playNote(note + 48, 1.0, 1.0, 0), chord);\n  synth.playNote(clefOffsets[clef] + 36, 1.0, 1.0, 0);\n};\n","import { useDefaultProps, FC } from 'react-default-props-context';\nimport { observer } from 'mobx-react-lite';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport { useStore } from 'src/app/components';\nimport { playChord } from 'src/voicings/utils/playChord';\nimport { QuizState } from 'src/quiz/QuizState';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\ntype DefaultPropsT = {\n  quizState: QuizState;\n};\n\nexport const InversionSelector: FC<PropsT, DefaultPropsT> = observer(\n  (p: PropsT) => {\n    const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n    const { voicingStore } = useStore();\n    return (\n      <KeyboardEventHandler\n        handleKeys={['ctrl+left', 'ctrl+right']}\n        onKeyEvent={(key: string, e: any) => {\n          if (key === 'ctrl+right') {\n            voicingStore.setInversion(voicingStore.inversion + 1);\n            if (props.quizState.query) {\n              props.quizState.query.inversion = voicingStore.inversion;\n            }\n          }\n          if (key === 'ctrl+left') {\n            voicingStore.setInversion(voicingStore.inversion - 1);\n            if (props.quizState.query) {\n              props.quizState.query.inversion = voicingStore.inversion;\n            }\n          }\n        }}\n      >\n        <KeyboardEventHandler\n          handleKeys={['p']}\n          onKeyEvent={(key: string, e: any) => {\n            playChord(voicingStore.chord, voicingStore.clef);\n          }}\n        >\n          {props.children}\n        </KeyboardEventHandler>\n      </KeyboardEventHandler>\n    );\n  }\n);\n","import { observer } from 'mobx-react-lite';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport { useStore } from 'src/app/components';\n\nexport const ClefModulationSelector = observer(({ children }) => {\n  const { preselectionStore } = useStore();\n\n  return (\n    <KeyboardEventHandler\n      handleKeys={['up', 'down']}\n      handleEventType=\"keydown\"\n      onKeyEvent={(key: string, e: any) => {\n        preselectionStore.setIsSharpening(key === 'up');\n        preselectionStore.setIsFlattening(key === 'down');\n      }}\n    >\n      <KeyboardEventHandler\n        handleKeys={['up', 'down']}\n        handleEventType=\"keyup\"\n        onKeyEvent={(key: string, e: any) => {\n          preselectionStore.reset();\n        }}\n      >\n        {children}\n      </KeyboardEventHandler>\n    </KeyboardEventHandler>\n  );\n});\n","import { observer } from 'mobx-react-lite';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport { useStore } from 'src/app/components';\nimport { clefLetters } from 'src/keyboard/keyConstants';\n\nexport const ClefSelector = observer(({ children }) => {\n  const { preselectionStore } = useStore();\n\n  return (\n    <KeyboardEventHandler\n      handleKeys={clefLetters}\n      handleEventType=\"keydown\"\n      onKeyEvent={(key: string, e: any) => {\n        preselectionStore.setClefLetter(key);\n      }}\n    >\n      <KeyboardEventHandler\n        handleKeys={clefLetters}\n        handleEventType=\"keyup\"\n        onKeyEvent={(key: string, e: any) => {\n          preselectionStore.reset();\n        }}\n      >\n        {children}\n      </KeyboardEventHandler>\n    </KeyboardEventHandler>\n  );\n});\n","export const noteColours: { [key: number]: string } = {\n  0: '#aaaaaa',\n  1: '#fa9835-striped',\n  2: '#fa9835', // orange\n  3: '#40d530-striped',\n  4: '#40d530', // green\n  5: '#fee449', // yellow\n  6: '#f53311-striped',\n  7: '#f53311', // red\n  8: '#38baf2-striped',\n  9: '#38baf2', // blue\n  10: '#ff99ff-striped',\n  11: '#ff99ff', // violet\n};\n","import React from 'react';\nimport { observer } from 'mobx-react-lite';\nimport { always, map, flow, range } from 'lodash/fp';\nimport { Rect } from 'react-konva';\n\ntype PropsT = {\n  x: number;\n  y: number;\n  height: number;\n  width: number;\n  fill: any;\n  backgroundColour: any;\n  isStriped: boolean;\n};\n\nexport const Marker: React.FC<PropsT> = observer((props: PropsT) => {\n  const filledStripeHeight = 5;\n  const bgStripeHeight = 3.5;\n  const nrOfStripes = Math.floor(\n    props.height / (0.5 * (filledStripeHeight + bgStripeHeight))\n  );\n\n  return props.isStriped\n    ? (flow(\n        always(range(0, nrOfStripes)),\n        map((stripeIdx) => {\n          const nrBg = Math.floor(stripeIdx / 2);\n          const nrFilled = stripeIdx - nrBg;\n          const isFilled = stripeIdx % 2 == 0;\n          const y =\n            props.y + nrFilled * filledStripeHeight + nrBg * bgStripeHeight;\n          const height = isFilled ? filledStripeHeight : bgStripeHeight;\n\n          return (\n            <Rect\n              key={stripeIdx}\n              x={props.x + 1}\n              y={y}\n              fill={isFilled ? props.fill : props.backgroundColour}\n              width={props.width - 2}\n              height={height}\n              strokeWidth={0}\n              opacity={1}\n            />\n          );\n        })\n      )() as any)\n    : ([\n        <Rect\n          key={0}\n          x={props.x + 1}\n          y={props.y}\n          fill={props.fill}\n          width={props.width - 2}\n          height={props.height}\n          strokeWidth={0}\n          opacity={1}\n        />,\n      ] as any);\n});\n","import { always, indexOf, map, flow, range } from 'lodash/fp';\nimport React from 'react';\nimport { Rect } from 'react-konva';\nimport { observer } from 'mobx-react-lite';\n\nimport {\n  blackKeyIndexes,\n  isWhiteKeyIndex,\n  whiteKeyIndexes,\n} from 'src/keyboard/keyConstants';\nimport { Marker } from 'src/keyboard/components/Marker';\n\nconst whiteKeyProps = {\n  width: 50,\n  height: 250,\n  fill: '#FFFFFF',\n  markerHeight: 56,\n};\n\nconst blackKeyProps = {\n  width: 25,\n  height: 160,\n  fill: '#444444',\n  markerHeight: 100,\n};\n\nconst whiteKeyX = flow(\n  always(range(0, 7)),\n  map((i) => i * whiteKeyProps.width)\n)();\n\nconst fraction = (x: number) => x * blackKeyProps.width;\nconst blackKeyX = [\n  whiteKeyX[1] - fraction(0.66),\n  whiteKeyX[2] - fraction(0.33),\n  whiteKeyX[4] - fraction(0.7),\n  whiteKeyX[5] - fraction(0.5),\n  whiteKeyX[6] - fraction(0.3),\n];\n\nconst getKeyX = (keyIndex: number) => {\n  const isWhiteKey = isWhiteKeyIndex(keyIndex);\n  const keyX = isWhiteKey ? whiteKeyX : blackKeyX;\n  const keyIndexes = isWhiteKey ? whiteKeyIndexes : blackKeyIndexes;\n  return keyX[indexOf(keyIndex, keyIndexes)];\n};\n\ntype PropsT = {\n  index: number;\n  octaveIndex: number;\n  markerColour?: string;\n  markerIsStriped: boolean;\n};\n\nexport const Key = observer((props: PropsT) => {\n  const isWhiteKey = isWhiteKeyIndex(props.index);\n  const keyProps = isWhiteKey ? whiteKeyProps : blackKeyProps;\n\n  const offsetY = 0;\n  const markerOffsetY = isWhiteKey ? 3 : 2;\n  const offsetX = props.octaveIndex * 7 * whiteKeyProps.width;\n\n  const x = offsetX + getKeyX(props.index);\n\n  return (\n    <React.Fragment>\n      <Rect\n        x={x}\n        y={offsetY}\n        fill={keyProps.fill}\n        stroke=\"#000000\"\n        opacity={1}\n        width={keyProps.width}\n        height={keyProps.height}\n      />\n      <Marker\n        x={x + 2}\n        y={offsetY + keyProps.height - keyProps.markerHeight - markerOffsetY}\n        height={keyProps.markerHeight}\n        width={keyProps.width - 4}\n        fill={props.markerColour}\n        isStriped={props.markerIsStriped}\n        backgroundColour={keyProps.fill}\n      />\n    </React.Fragment>\n  );\n});\n","import React from 'react';\nimport { observer } from 'mobx-react-lite';\nimport { always, concat, map, flow, add } from 'lodash/fp';\nimport { Layer } from 'react-konva';\n\nimport {\n  blackKeyIndexes,\n  noteValueToIndex,\n  octaveRootNoteValue,\n  whiteKeyIndexes,\n} from 'src/keyboard/keyConstants';\nimport { noteValueToColour } from 'src/keyboard/utils/noteValueToColour';\nimport { Key } from 'src/keyboard/components/Key';\n\ntype PropsT = {\n  index: number;\n  clef: string;\n  chord: any;\n};\n\nexport const Octave = observer((props: PropsT) => {\n  const keyIndexes = concat(whiteKeyIndexes, blackKeyIndexes);\n  const keys = flow(\n    always(keyIndexes),\n    map(add(octaveRootNoteValue(props.index))),\n    map((noteValue) => {\n      const keyIndex = noteValueToIndex(noteValue);\n      const { colour, isStriped } = noteValueToColour(\n        noteValue,\n        props.clef,\n        props.chord\n      );\n      return (\n        <Key\n          key={noteValue}\n          index={keyIndex}\n          octaveIndex={props.index}\n          markerColour={colour}\n          markerIsStriped={isStriped}\n        />\n      );\n    })\n  )();\n  return <Layer>{keys}</Layer>;\n});\n","import { includes, split } from 'lodash/fp';\n\nimport { noteColours } from 'src/keyboard/noteColours';\nimport { noteValueToIndex, clefOffsets } from 'src/keyboard/keyConstants';\nimport { ChordT, NoteT } from 'src/voicings/types';\n\nexport function noteValueToColour(\n  noteValue: NoteT,\n  clef: string,\n  chord: ChordT\n) {\n  const harmonicColour = includes(noteValue, chord)\n    ? noteColours[noteValueToIndex(noteValue - clefOffsets[clef])]\n    : undefined;\n\n  const isStriped = !!(harmonicColour && harmonicColour.endsWith('-striped'));\n  const colour = isStriped\n    ? split('-striped', harmonicColour)[0]\n    : harmonicColour;\n\n  return { colour, isStriped };\n}\n","import { observer } from 'mobx-react-lite';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport { useDefaultProps, FC } from 'react-default-props-context';\nimport { QuizState } from 'src/quiz/QuizState';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\ntype DefaultPropsT = {\n  quizState: QuizState;\n};\n\nexport const RandomChordSelector: FC<PropsT, DefaultPropsT> = observer(\n  (p: PropsT) => {\n    const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n\n    return (\n      <KeyboardEventHandler\n        handleKeys={['space', 'enter']}\n        onKeyEvent={(key: string, e: any) => {\n          props.quizState.pickRandomChord();\n        }}\n      >\n        {props.children}\n      </KeyboardEventHandler>\n    );\n  }\n);\n","import { useDefaultProps, FC } from 'react-default-props-context';\nimport { always, flow, map, range } from 'lodash/fp';\nimport { observer } from 'mobx-react-lite';\nimport { Stage } from 'react-konva';\nimport { useStore } from 'src/app/components';\nimport { InversionSelector } from 'src/voicings/components/InversionSelector';\nimport 'src/keyboard/components/Keyboard.css';\nimport { ClefModulationSelector } from 'src/keyboard/components/ClefModulationSelector';\nimport { ClefSelector } from 'src/keyboard/components/ClefSelector';\nimport { Octave } from 'src/keyboard/components/Octave';\nimport { RandomChordSelector } from 'src/voicings/components/RandomChordSelector';\n\ntype PropsT = {\n  onClick: (event: any) => void;\n};\n\ntype DefaultPropsT = {};\n\nexport const Keyboard: FC<PropsT, DefaultPropsT> = observer((p: PropsT) => {\n  const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n\n  const { voicingStore, clefStore } = useStore();\n\n  const octaves = flow(\n    always(range(0, 4)),\n    map((i) => (\n      <Octave\n        key={i}\n        index={i}\n        clef={clefStore.clef}\n        chord={voicingStore.chord}\n      />\n    ))\n  )();\n\n  return (\n    <div className=\"Keyboard__frame\" onClick={props.onClick}>\n      <RandomChordSelector>\n        <ClefSelector>\n          <ClefModulationSelector>\n            <InversionSelector>\n              <div tabIndex={0}>\n                <Stage width={1400} height={250}>\n                  {octaves}\n                </Stage>\n              </div>\n            </InversionSelector>\n          </ClefModulationSelector>\n        </ClefSelector>\n      </RandomChordSelector>\n    </div>\n  );\n});\n","import classnames from 'classnames';\nimport { always, flow, map } from 'lodash/fp';\nimport { observer } from 'mobx-react-lite';\nimport { useDefaultProps, FC } from 'react-default-props-context';\nimport { ClefListViewItem } from 'src/keyboard/components';\nimport { ClefT } from 'src/keyboard/types';\nimport { Selection } from 'skandha-facets/Selection';\n\nimport './ClefListView.scss';\n\ntype PropsT = {\n  className?: any;\n};\n\ntype DefaultPropsT = {\n  clefs: ClefT[];\n  clefsSelection: Selection;\n};\n\nexport const ClefListView: FC<PropsT, DefaultPropsT> = observer((p: PropsT) => {\n  const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n\n  const clefDivs = flow(\n    always(props.clefs),\n    map((x) => (\n      <ClefListViewItem\n        key={x}\n        clef={x}\n        className={classnames(\n          {\n            'ClefListViewItem--selected': props.clefsSelection.ids.includes(x),\n          },\n          props.className\n        )}\n        onMouseDown={(e: any) => {\n          props.clefsSelection.selectItem({\n            itemId: x,\n            isShift: false,\n            isCtrl: true,\n          });\n        }}\n      />\n    ))\n  )();\n\n  const noItems = <h2>There are no clefs</h2>;\n\n  return (\n    <div className=\"ClefListView flex flex-row w-full\">\n      {clefDivs.length && clefDivs}\n      {!clefDivs.length && noItems}\n    </div>\n  );\n});\n","import React from 'react';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react-lite';\nimport { ClefT } from 'src/keyboard/types';\n\nimport './ClefListViewItem.scss';\n\nexport type PropsT = {\n  clef: ClefT;\n  onMouseDown: (event: any) => void;\n  className?: any;\n};\n\nexport const ClefListViewItem: React.FC<PropsT> = observer((props: PropsT) => {\n  return (\n    <div\n      className={classnames('ClefListViewItem flex-1', props.className)}\n      onMouseDown={props.onMouseDown}\n    >\n      {props.clef}\n    </div>\n  );\n});\n","import { valueByNoteName } from 'src/voicings/noteConstants';\nimport { map } from 'lodash/fp';\n\nexport const parseVoicing = (data: any) => {\n  const voicing = {\n    ...data,\n    chord: map((x: string) => {\n      const noteValue = (valueByNoteName as any)[x as any];\n      if (noteValue === undefined) {\n        console.log(`Error: unknown note ${x}`);\n      }\n      return noteValue;\n    }, data['chord']),\n  };\n\n  for (let i = 1; i < voicing.chord.length; ++i) {\n    while (voicing.chord[i] <= voicing.chord[i - 1]) {\n      voicing.chord[i] += 12;\n    }\n  }\n\n  return voicing;\n};\n\nconst parseVoicingGroup = (data: any) => {\n  return {\n    ...data,\n    voicings: map(parseVoicing, data['voicings']),\n  };\n};\n\nexport const cache = {\n  data: null,\n};\n\nexport const parseVoicingGroups = (data: any) => {\n  cache.data = data;\n  return map(parseVoicingGroup, data);\n};\n","import { observer } from 'mobx-react-lite';\nimport { useDefaultProps, FC } from 'react-default-props-context';\nimport Dropdown, { MenuItem } from '@trendmicro/react-dropdown';\nimport { QuizState } from 'src/quiz/QuizState';\nimport { cache, parseVoicingGroups } from 'src/voicings/parse';\n\nimport '@trendmicro/react-buttons/dist/react-buttons.css';\nimport '@trendmicro/react-dropdown/dist/react-dropdown.css';\n\nimport './IoMenu.scss';\n\nconst twitterUrl = `https://twitter.com/intent/tweet?url=www.brainpiano.ai&hashtags=BrainPiano`;\n\ntype PropsT = {};\n\ntype DefaultPropsT = {\n  quizState: QuizState;\n};\n\nexport const IoMenu: FC<PropsT, DefaultPropsT> = observer((p: PropsT) => {\n  const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n\n  return (\n    <Dropdown\n      onSelect={(eventKey: any) => {\n        if (eventKey === 1) {\n          navigator.clipboard.writeText(JSON.stringify(cache.data, null, 2));\n        }\n        if (eventKey === 2) {\n          window.open(twitterUrl);\n        }\n        if (eventKey === 3) {\n          navigator.clipboard.readText().then((clipText) => {\n            debugger;\n            props.quizState.setGroups(parseVoicingGroups(JSON.parse(clipText)));\n          });\n        }\n      }}\n      autoOpen={true}\n      pullRight={true}\n    >\n      <Dropdown.Toggle btnSize=\"lg\" btnStyle=\"flat\">\n        IO\n      </Dropdown.Toggle>\n      <Dropdown.Menu>\n        <MenuItem eventKey={1}>Export</MenuItem>\n        <MenuItem divider />\n        <MenuItem eventKey={2}>Tweet</MenuItem>\n        <MenuItem divider />\n        <MenuItem eventKey={3}>Import</MenuItem>\n      </Dropdown.Menu>\n    </Dropdown>\n  );\n});\n","import React from 'react';\nimport { useDefaultProps, FC } from 'react-default-props-context';\nimport classnames from 'classnames';\nimport { observer } from 'mobx-react-lite';\nimport { VoicingTitle } from 'src/voicings/components/VoicingTitle';\nimport { GroupPicker } from 'src/groups/components';\nimport { ClefListView } from 'src/keyboard/components';\nimport { QuizState } from 'src/quiz/QuizState';\nimport { IoMenu } from 'src/io/components';\n\nimport './QuizFrameTopPanel.scss';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\ntype DefaultPropsT = {\n  quizState: QuizState;\n};\n\nexport const QuizFrameTopPanel: FC<PropsT, DefaultPropsT> = observer(\n  (p: PropsT) => {\n    const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n    const HelpButton = (\n      <button\n        onClick={() =>\n          window.open('https://github.com/mnieber/brainpiano#brainpiano')\n        }\n      >\n        Help\n      </button>\n    );\n\n    return (\n      <div className={classnames('QuizFrameTopPanel mb-4')}>\n        <div className=\"QuizFrameTopPanel__firstRow mb4 flex flex-row justify-between\">\n          <VoicingTitle query={props.quizState.query} />\n          {HelpButton}\n          <VoicingTitle\n            label={\n              props.quizState.nextQuery ? 'Next: ' : 'Welcome to BrainPiano!'\n            }\n            query={props.quizState.nextQuery}\n          />\n        </div>\n        <GroupPicker className=\"flex-1\" />\n        <div className=\"flex flex-row justify-between mt-2\">\n          <ClefListView className=\"flex-1\" />\n          <IoMenu />\n        </div>\n      </div>\n    );\n  }\n);\n","import React from 'react';\nimport { useDefaultProps, FC } from 'react-default-props-context';\nimport { observer } from 'mobx-react-lite';\nimport { Keyboard } from 'src/keyboard/components/Keyboard';\nimport { QuizFrame } from 'src/quiz/components';\nimport { QuizState } from 'src/quiz/QuizState';\n\ntype PropsT = {};\n\ntype DefaultPropsT = {\n  quizState: QuizState;\n};\n\nexport const QuizView: FC<PropsT, DefaultPropsT> = observer((p: PropsT) => {\n  const props = useDefaultProps<PropsT, DefaultPropsT>(p);\n\n  const onClick = React.useMemo(() => () => props.quizState.pickRandomChord(), [\n    props.quizState,\n  ]);\n  return (\n    <QuizFrame>\n      <Keyboard onClick={onClick} />\n    </QuizFrame>\n  );\n});\n","export var symbols = {\n    admin: Symbol(\"aspiration administration\"),\n};\n","import { symbols } from \"./symbols\";\nexport function getOrCreate(obj, key, fn) {\n    if (!obj[key]) {\n        obj[key] = fn();\n    }\n    return obj[key];\n}\nexport function getAdmin(host) {\n    return getOrCreate(host, symbols.admin, function () { return ({}); });\n}\n","import { getAdmin } from \"./internal/utils\";\nvar STRIP_COMMENTS = /(\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/)|(\\s*=[^,\\)]*(('(?:\\\\'|[^'\\r\\n])*')|(\"(?:\\\\\"|[^\"\\r\\n])*\"))|(\\s*=[^,\\)]*))/gm;\nvar ARGUMENT_NAMES = /([^\\s,]+)/g;\nfunction getParamNames(func) {\n    var fnStr = func.toString().replace(STRIP_COMMENTS, \"\");\n    var result = fnStr\n        .slice(fnStr.indexOf(\"(\") + 1, fnStr.indexOf(\")\"))\n        .match(ARGUMENT_NAMES);\n    if (result === null)\n        result = [];\n    return result;\n}\nfunction _setDefaultCallbacks(hostObjectAdmin, propertyName, defaultCbs) {\n    var _a;\n    hostObjectAdmin.defaultCallbackMap = (_a = hostObjectAdmin.defaultCallbackMap) !== null && _a !== void 0 ? _a : {};\n    hostObjectAdmin.defaultCallbackMap[propertyName] = defaultCbs;\n    return defaultCbs;\n}\nfunction _host(target, propertyName, descriptor, createDefaultCbs) {\n    var f = descriptor.value;\n    if (typeof descriptor.value === \"function\") {\n        descriptor.value = function () {\n            var _a, _b, _c, _d, _e;\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            var admin = getAdmin(this);\n            var callbacks = (_d = (_b = (_a = admin.callbackMap) === null || _a === void 0 ? void 0 : _a[propertyName]) !== null && _b !== void 0 ? _b : (_c = admin.defaultCallbackMap) === null || _c === void 0 ? void 0 : _c[propertyName]) !== null && _d !== void 0 ? _d : _setDefaultCallbacks(admin, propertyName, createDefaultCbs(this));\n            if (!admin.paramNamesMap)\n                admin.paramNamesMap = {};\n            var paramNames = (admin.paramNamesMap[propertyName] =\n                (_e = admin.paramNamesMap[propertyName]) !== null && _e !== void 0 ? _e : getParamNames(f));\n            // Create memo of param values\n            var paramsMemo = {};\n            for (var idx = 0, n = paramNames.length; idx < n; ++idx) {\n                var paramName = paramNames[idx];\n                paramsMemo[paramName] = callbacks[paramName];\n                callbacks[paramName] = args[idx];\n            }\n            if (callbacks.enter)\n                callbacks.enter();\n            var returnValue = f.bind(this).apply(void 0, args)(callbacks);\n            if (callbacks.exit)\n                callbacks.exit();\n            // Restore memo of param values\n            for (var idx = 0, n = paramNames.length; idx < n; ++idx) {\n                var paramName = paramNames[idx];\n                callbacks[paramName] = paramsMemo[paramName];\n            }\n            return returnValue;\n        };\n    }\n    return descriptor;\n}\nexport function host() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    if (args.length === 1) {\n        var wrapped = function (target, propertyName, descriptor) {\n            return _host(target, propertyName, descriptor, args[0]);\n        };\n        return wrapped;\n    }\n    var target = args[0], propertyName = args[1], descriptor = args[2];\n    return _host(target, propertyName, descriptor, function () { return ({}); });\n}\nexport function setCallbacks(host, cbs) {\n    var _a;\n    var admin = getAdmin(host);\n    admin.callbackMap = cbs;\n    admin.defaultCallbackMap = (_a = admin.defaultCallbackMap) !== null && _a !== void 0 ? _a : {};\n}\nvar Cbs = /** @class */ (function () {\n    function Cbs() {\n    }\n    Cbs.prototype.enter = function () { };\n    Cbs.prototype.exit = function () { };\n    return Cbs;\n}());\nexport { Cbs };\nexport var stub = function () { return undefined; };\nexport var nop = function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    return undefined;\n};\nexport var maybe = function (x) { return x !== null && x !== void 0 ? x : nop; };\n","export var symbols = {\n    admin: Symbol(\"skandha administration\"),\n};\n","var __spreadArray = (this && this.__spreadArray) || function (to, from) {\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\n        to[j] = from[i];\n    return to;\n};\nimport { symbols } from \"./symbols\";\nexport function getOrCreate(obj, key, fn) {\n    if (!obj[key]) {\n        obj[key] = fn();\n    }\n    return obj[key];\n}\nexport var zip = function (arr) {\n    var arrs = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        arrs[_i - 1] = arguments[_i];\n    }\n    return arr.map(function (val, i) {\n        return arrs.reduce(function (a, arr) { return __spreadArray(__spreadArray([], a), [arr[i]]); }, [val]);\n    });\n};\nexport function getCtrClassAdmin(ctrClass) {\n    return getOrCreate(ctrClass, symbols.admin, function () { return ({}); });\n}\nexport function getCtrAdmin(ctr) {\n    return getOrCreate(ctr, symbols.admin, function () { return ({}); });\n}\nexport function getFacetClassAdmin(facetClass) {\n    return getOrCreate(facetClass, symbols.admin, function () { return ({}); });\n}\nexport function getFacetAdmin(facet) {\n    return getOrCreate(facet, symbols.admin, function () { return ({}); });\n}\n","import { getFacetClassAdmin } from \"../internal/utils\";\nexport function log(dataHost, dataMember, descriptor) {\n    var _a;\n    if (descriptor === void 0) { descriptor = undefined; }\n    var facetClassAdmin = getFacetClassAdmin(dataHost.constructor);\n    facetClassAdmin.loggedMembers = (_a = facetClassAdmin.loggedMembers) !== null && _a !== void 0 ? _a : {};\n    facetClassAdmin.loggedMembers[dataMember] = true;\n    return descriptor;\n}\nexport function data(dataHost, dataMember, descriptor) {\n    var _a;\n    if (descriptor === void 0) { descriptor = undefined; }\n    var facetClassAdmin = getFacetClassAdmin(dataHost.constructor);\n    facetClassAdmin.dataMembers = (_a = facetClassAdmin.dataMembers) !== null && _a !== void 0 ? _a : {};\n    facetClassAdmin.dataMembers[dataMember] = true;\n    return log(dataHost, dataMember, descriptor);\n}\nexport function getLoggedMemberNames(facet) {\n    var _a;\n    return Object.keys((_a = getFacetClassAdmin(facet.constructor).loggedMembers) !== null && _a !== void 0 ? _a : {});\n}\nexport function getDataMemberNames(facet) {\n    var _a;\n    return Object.keys((_a = getFacetClassAdmin(facet.constructor).dataMembers) !== null && _a !== void 0 ? _a : {});\n}\nexport var input = data;\nexport var output = data;\n","import { getCtrAdmin, getFacetAdmin } from \"../internal/utils\";\nexport function getc(facet) {\n    return getFacetAdmin(facet).parentContainer;\n}\nexport function setCtr(facet, ctr) {\n    getFacetAdmin(facet).parentContainer = ctr;\n}\nexport function getFacetMemberNames(ctr) {\n    var _a;\n    return (_a = getCtrAdmin(ctr).facetMembers) !== null && _a !== void 0 ? _a : [];\n}\nexport function addCleanUpFunctionToCtr(ctr, f) {\n    var _a;\n    var ctrAdmin = getCtrAdmin(ctr);\n    ctrAdmin.cleanUpFunctions = (_a = ctrAdmin.cleanUpFunctions) !== null && _a !== void 0 ? _a : [];\n    ctrAdmin.cleanUpFunctions.push(f);\n}\nexport function cleanUpCtr(ctr) {\n    var _a;\n    var ctrAdmin = getCtrAdmin(ctr);\n    ctrAdmin.cleanUpFunctions = (_a = ctrAdmin.cleanUpFunctions) !== null && _a !== void 0 ? _a : [];\n    ctrAdmin.cleanUpFunctions.forEach(function (x) { return x(); });\n}\n","export var options = {\n    logging: false,\n    formatObject: function (x) { return x; },\n};\nexport var getOptions = function () { return options; };\nexport var setOptions = function (moreOptions) {\n    Object.assign(options, moreOptions);\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { getLoggedMemberNames } from \"../lib/data\";\nimport { getCtrAdmin, getFacetAdmin } from \"../internal/utils\";\nimport { getc, getFacetMemberNames } from \"../lib/ctr\";\nimport { options } from \"./options\";\nexport function _defaultFacetLogName(facet) {\n    var ctr = getc(facet);\n    var prefix = ctr ? ctr.constructor.name + \"/\" : \"\";\n    return prefix + facet.constructor.name;\n}\nexport function facetLogName(facet) {\n    var _a;\n    return (_a = getFacetAdmin(facet).logName) !== null && _a !== void 0 ? _a : _defaultFacetLogName(facet);\n}\nfunction camelToSnake(string) {\n    return string\n        .replace(/[\\w]([A-Z])/g, function (m) {\n        return m[0] + \"_\" + m[1];\n    })\n        .toLowerCase();\n}\nvar opName = function (operationMember) { return camelToSnake(operationMember).toUpperCase(); };\nexport function log(facet, operationMember, args, start) {\n    var _a;\n    var ctr = getc(facet);\n    var ctrAdmin = ctr ? getCtrAdmin(ctr) : undefined;\n    var getCtrState = (_a = ctrAdmin === null || ctrAdmin === void 0 ? void 0 : ctrAdmin.ctrStateOverride) !== null && _a !== void 0 ? _a : ctrState;\n    var getState = ctr ? function () { return getCtrState(ctr); } : function () { return facetState(facet); };\n    var operationName = opName(operationMember);\n    var label = facetLogName(facet) + \".\" + operationName;\n    if (start) {\n        console.group(label);\n        console.log(\"%c           args: \", \"color: gray\", args);\n        console.log(\"%c     state\", \"color: gray\", getState());\n    }\n    else {\n        console.log(\"%c     next\", \"color: gray\", getState());\n        // @ts-ignore\n        console.groupEnd(label);\n    }\n}\nexport function facetState(facet) {\n    return getLoggedMemberNames(facet).reduce(function (acc, loggedMember) {\n        var _a;\n        try {\n            var data = options.formatObject(facet[loggedMember]);\n            return __assign(__assign({}, acc), (_a = {}, _a[loggedMember] = data, _a));\n        }\n        catch (_b) {\n            return acc;\n        }\n    }, {});\n}\nexport function ctrState(ctr) {\n    if (ctr) {\n        return getFacetMemberNames(ctr).reduce(function (acc, facetMemberName) {\n            var _a;\n            var facet = ctr[facetMemberName];\n            return __assign(__assign({}, acc), (_a = {}, _a[facetMemberName] = facetState(facet), _a));\n        }, {});\n    }\n}\n","import { setCtr } from \"./ctr\";\nimport { getCtrClassAdmin, getCtrAdmin, getFacetAdmin, } from \"../internal/utils\";\nexport function facet(facetHost, facetMember, descriptor) {\n    var _a;\n    if (descriptor === void 0) { descriptor = undefined; }\n    var ctrClassAdmin = getCtrClassAdmin(facetHost.constructor);\n    ctrClassAdmin.facetMembers = (_a = ctrClassAdmin.facetMembers) !== null && _a !== void 0 ? _a : [];\n    ctrClassAdmin.facetMembers.push(facetMember);\n    return descriptor;\n}\nexport function registerFacets(ctr, options) {\n    var _a, _b, _c, _d, _e;\n    var ctrName = (_a = options.name) !== null && _a !== void 0 ? _a : ctr.constructor.name;\n    var ctrAdmin = getCtrAdmin(ctr);\n    ctrAdmin.facetMembers = (_b = ctrAdmin.facetMembers) !== null && _b !== void 0 ? _b : [];\n    ctrAdmin.facetByFacetClassName = (_c = ctrAdmin.facetByFacetClassName) !== null && _c !== void 0 ? _c : {};\n    ctrAdmin.ctrStateOverride = options.ctrState;\n    ((_e = (_d = options.members) !== null && _d !== void 0 ? _d : getCtrClassAdmin(ctr.constructor).facetMembers) !== null && _e !== void 0 ? _e : Object.getOwnPropertyNames(ctr)).forEach(function (member) {\n        ctrAdmin.facetMembers.push(member);\n        var facet = ctr[member];\n        setCtr(facet, ctr);\n        var facetAdmin = getFacetAdmin(facet);\n        facetAdmin.logName = ctrName + \"/\" + facet.constructor.name;\n        var className = facet.constructor.name;\n        if (ctrAdmin.facetByFacetClassName[className] !== undefined) {\n            console.error(\"Two facets of same type \" + className + \" in container \" + options.name);\n        }\n        ctrAdmin.facetByFacetClassName[className] = facet;\n    });\n}\nexport function getf(facetClass, ctr) {\n    var _a;\n    if (!ctr)\n        return function (ctr) { return getf(facetClass, ctr); };\n    var facet = (_a = getCtrAdmin(ctr).facetByFacetClassName) === null || _a === void 0 ? void 0 : _a[facetClass.name];\n    if (!facet) {\n        console.error(\"No facet \" + facetClass.name + \" in container \" + ctr.constructor.name);\n    }\n    return facet;\n}\nexport function getm(classMember) {\n    var f = function (ctr) { var _a; return getf(classMember[0], (_a = classMember[2]) !== null && _a !== void 0 ? _a : ctr)[classMember[1]]; };\n    // Set some properties on f to easy debugging later\n    f.facetClassName = classMember[0].name;\n    f.facetMemberName = classMember[1];\n    return f;\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { getf } from \"./facet\";\nimport { facetLogName } from \"../internal/logging\";\nimport { getDataMemberNames } from \"./data\";\nexport function mapDataToProp(facet, prop, getter) {\n    delete facet[prop];\n    Object.defineProperty(facet, prop, {\n        get: getter,\n        enumerable: true,\n        configurable: true,\n    });\n}\nexport function patchFacet(facet, members, options) {\n    var _a;\n    var dataMemberNames = getDataMemberNames(facet);\n    for (var prop in members) {\n        if ((_a = options === null || options === void 0 ? void 0 : options.warnIfNotADataMember) !== null && _a !== void 0 ? _a : true) {\n            if (!dataMemberNames.includes(prop)) {\n                console.error(\"Patching a property \" + prop + \" that wasn't decorated with \" +\n                    (\"@data, @input or @output in \" + facetLogName(facet)));\n            }\n        }\n        delete facet[prop];\n        Object.defineProperty(facet, prop, __assign(__assign({}, members[prop]), { enumerable: true, configurable: true }));\n    }\n}\nexport var mapDataToFacet = function (_a, getter, transform) {\n    var toFacetClass = _a[0], toMember = _a[1], toCtr = _a[2];\n    return function (ctr) {\n        var _a;\n        var patch = (_a = {},\n            _a[toMember] = {\n                get: function () {\n                    var context = {\n                        ctr: toCtr !== null && toCtr !== void 0 ? toCtr : ctr,\n                        getter: getter,\n                        toClassMember: [toFacetClass, toMember],\n                        data: getter(ctr),\n                    };\n                    return transform ? transform(context.data) : context.data;\n                },\n            },\n            _a);\n        patchFacet(getf(toFacetClass, toCtr !== null && toCtr !== void 0 ? toCtr : ctr), patch);\n    };\n};\nexport var mapDatasToFacet = function (_a, getters, transform) {\n    var toFacetClass = _a[0], toMember = _a[1], toCtr = _a[2];\n    return function (ctr) {\n        var _a;\n        var patch = (_a = {},\n            _a[toMember] = {\n                get: function () {\n                    var context = {\n                        ctr: toCtr !== null && toCtr !== void 0 ? toCtr : ctr,\n                        getters: getters,\n                        toClassMember: [toFacetClass, toMember],\n                        datas: getters.map(function (getter) { return getter(ctr); }),\n                    };\n                    return transform.apply(void 0, context.datas);\n                },\n            },\n            _a);\n        patchFacet(getf(toFacetClass, toCtr !== null && toCtr !== void 0 ? toCtr : ctr), patch);\n    };\n};\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { options } from \"../internal/options\";\nimport { log } from \"../internal/logging\";\nimport { getFacetClassAdmin } from \"../internal/utils\";\nfunction _operation(target, propertyName, descriptor, punctualOptions) {\n    var _a;\n    var f = descriptor.value;\n    var facetClassAdmin = getFacetClassAdmin(target.constructor);\n    facetClassAdmin.operationMemberNames =\n        (_a = facetClassAdmin.operationMemberNames) !== null && _a !== void 0 ? _a : [];\n    facetClassAdmin.operationMemberNames.push(propertyName);\n    if (typeof descriptor.value === \"function\") {\n        descriptor.value = !!punctualOptions.async\n            ? function () {\n                var _a;\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                return __awaiter(this, void 0, void 0, function () {\n                    var facet, isLogging, returnValue;\n                    return __generator(this, function (_b) {\n                        switch (_b.label) {\n                            case 0:\n                                facet = this;\n                                isLogging = options.logging && ((_a = punctualOptions.log) !== null && _a !== void 0 ? _a : true);\n                                isLogging && log(facet, propertyName, args, true);\n                                return [4 /*yield*/, f.bind(this).apply(void 0, args)];\n                            case 1:\n                                returnValue = _b.sent();\n                                isLogging && log(facet, propertyName, args, false);\n                                return [2 /*return*/, Promise.resolve(returnValue)];\n                        }\n                    });\n                });\n            }\n            : function () {\n                var _a;\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                var facet = this;\n                var isLogging = options.logging && ((_a = punctualOptions.log) !== null && _a !== void 0 ? _a : true);\n                isLogging && log(facet, propertyName, args, true);\n                var returnValue = f.bind(this).apply(void 0, args);\n                isLogging && log(facet, propertyName, args, false);\n                return returnValue;\n            };\n    }\n    return descriptor;\n}\nexport function getOperationMemberNames(facet) {\n    var _a;\n    return (_a = getFacetClassAdmin(facet.constructor).operationMemberNames) !== null && _a !== void 0 ? _a : [];\n}\nexport function operation() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    if (args.length === 1) {\n        var wrapped = function (target, propertyName, descriptor) {\n            return _operation(target, propertyName, descriptor, args[0]);\n        };\n        return wrapped;\n    }\n    var target = args[0], propertyName = args[1], descriptor = args[2];\n    return _operation(target, propertyName, descriptor, {});\n}\n","export function installPolicies(policies, ctr) {\n    policies.forEach(function (policy) {\n        policy(ctr);\n    });\n}\n","export const symbols = {\n    admin: Symbol(\"skandha-mobx administration\"),\n};\n","import { symbols } from \"./symbols\";\nexport function getOrCreate(obj, key, fn) {\n    if (!obj[key]) {\n        obj[key] = fn();\n    }\n    return obj[key];\n}\nexport const getAdmin = (obj) => {\n    return getOrCreate(obj, symbols.admin, () => ({}));\n};\n","import { getAdmin } from \"../internal/utils\";\nimport { observable, action, makeObservable, computed, isObservableProp, isComputedProp, } from \"mobx\";\nimport { getFacetMemberNames, getDataMemberNames, getOperationMemberNames, } from \"skandha\";\nexport const makeCtrObservable = (ctr) => {\n    var _a;\n    getFacetMemberNames(ctr).forEach((facetName) => {\n        var _a;\n        const facet = ctr[facetName];\n        try {\n            makeFacetObservable(facet);\n        }\n        catch (_b) { }\n        ((_a = getAdmin(facet).effects) !== null && _a !== void 0 ? _a : []).forEach((f) => f());\n    });\n    try {\n        makeObservable(ctr);\n    }\n    catch (_b) { }\n    ((_a = getAdmin(ctr).effects) !== null && _a !== void 0 ? _a : []).forEach((f) => f());\n};\nexport const makeFacetObservable = (facet) => {\n    addActionsToFacet(facet);\n    try {\n        makeObservable(facet);\n    }\n    catch (_a) { }\n    const observableMembers = {};\n    getDataMemberNames(facet).forEach((dataMemberName) => {\n        var _a;\n        if (!isObservableProp(facet, dataMemberName) &&\n            !isComputedProp(facet, dataMemberName)) {\n            const descriptor = (_a = Object.getOwnPropertyDescriptor(facet, dataMemberName)) !== null && _a !== void 0 ? _a : Object.getOwnPropertyDescriptor(facet.constructor.prototype, dataMemberName);\n            observableMembers[dataMemberName] =\n                !descriptor || descriptor.get ? computed : observable;\n        }\n    });\n    try {\n        makeObservable(facet, observableMembers);\n    }\n    catch (_b) { }\n};\nconst addActionsToFacet = (facet) => {\n    getOperationMemberNames(facet).forEach((opName) => {\n        facet[opName] = action(facet[opName]);\n    });\n};\nexport const onMakeCtrObservable = (ctr, f) => {\n    var _a;\n    const ctrAdmin = getAdmin(ctr);\n    const effects = (ctrAdmin.effects = (_a = ctrAdmin.effects) !== null && _a !== void 0 ? _a : []);\n    effects.push(f);\n};\nexport const onMakeFacetObservable = (facet, f) => {\n    var _a;\n    const facetAdmin = getAdmin(facet);\n    const effects = (facetAdmin.effects = (_a = facetAdmin.effects) !== null && _a !== void 0 ? _a : []);\n    effects.push(f);\n};\n","export function listToItemById(qsList: Array<any>, key: string = 'id') {\n  const result: any = {};\n  qsList.forEach((item) => {\n    result[item[key]] = item;\n  });\n  return result;\n}\n\nexport function getIds(x: Array<any>): Array<string> {\n  return x.map((x) => x.id);\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { host } from \"aspiration\";\nimport { getm, mapDatasToFacet, mapDataToFacet, data, input, operation, output, } from \"skandha\";\nimport { lookUp, range } from \"./internal/utils\";\nconst selectItemDefaultCbs = (selection) => ({\n    selectItem: function () {\n        handleSelectItem(selection, this.selectionParams);\n    },\n});\nexport class Selection {\n    constructor() {\n        Object.defineProperty(this, \"selectableIds\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"ids\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: []\n        });\n        Object.defineProperty(this, \"anchorId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"items\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    selectItem(selectionParams) {\n        return (cbs) => {\n            cbs.selectItem();\n        };\n    }\n}\n__decorate([\n    input\n], Selection.prototype, \"selectableIds\", void 0);\n__decorate([\n    data\n], Selection.prototype, \"ids\", void 0);\n__decorate([\n    data\n], Selection.prototype, \"anchorId\", void 0);\n__decorate([\n    output\n], Selection.prototype, \"items\", void 0);\n__decorate([\n    operation,\n    host(selectItemDefaultCbs)\n], Selection.prototype, \"selectItem\", null);\nexport function handleSelectItem(facet, { itemId, isShift, isCtrl }) {\n    const hasItem = facet.ids.includes(itemId);\n    const selectableIds = facet.selectableIds;\n    if (!selectableIds) {\n        throw Error(\"logical error\");\n    }\n    if (isShift) {\n        const startItemId = facet.anchorId || itemId;\n        const startIdx = selectableIds.indexOf(startItemId);\n        const stopIdx = selectableIds.indexOf(itemId);\n        const idxRange = range(Math.min(startIdx, stopIdx), 1 + Math.max(startIdx, stopIdx));\n        facet.ids = idxRange.map((idx) => selectableIds[idx]);\n    }\n    else if (isCtrl) {\n        facet.ids = hasItem\n            ? facet.ids.filter((x) => x !== itemId)\n            : [...facet.ids, itemId];\n    }\n    else {\n        facet.ids = [itemId];\n    }\n    // Move the anchor\n    if (!facet.anchorId || !(isCtrl || isShift)) {\n        facet.anchorId = itemId;\n    }\n}\nexport const selectionUsesItemLookUpTable = (getItemById) => mapDatasToFacet([Selection, \"items\"], [\n    //\n    getItemById,\n    getm([Selection, \"ids\"]),\n], (itemById, ids) => {\n    return lookUp(ids, itemById);\n});\nexport const selectionUsesSelectableIds = (getIds, transform) => mapDataToFacet([Selection, \"selectableIds\"], getIds, transform);\n","export function lookUp(keys, obj) {\n    return keys.map((x) => obj[x]);\n}\nexport function range(start, stop) {\n    var ans = [];\n    for (let i = start; i < stop; i++) {\n        ans.push(i);\n    }\n    return ans;\n}\nexport const findMap = (f, items) => {\n    for (var item of items) {\n        const mapped = f(item);\n        if (mapped) {\n            return mapped;\n        }\n    }\n    return undefined;\n};\nexport function isBefore(e) {\n    const boundingRect = e.target.getBoundingClientRect();\n    const height = boundingRect.bottom - boundingRect.top;\n    const isBefore = e.clientY - boundingRect.top < 0.5 * height;\n    return isBefore;\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { host, maybe } from \"aspiration\";\nimport { data, getm, mapDatasToFacet, operation, output, } from \"skandha\";\nexport class Highlight {\n    constructor() {\n        Object.defineProperty(this, \"id\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"item\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    highlightItem(id) {\n        return (cbs) => {\n            this.id = id;\n            maybe(cbs.scrollItemIntoView).bind(cbs)();\n        };\n    }\n}\n__decorate([\n    data\n], Highlight.prototype, \"id\", void 0);\n__decorate([\n    output\n], Highlight.prototype, \"item\", void 0);\n__decorate([\n    operation,\n    host\n], Highlight.prototype, \"highlightItem\", null);\nexport const highlightUsesItemLookUpTable = (getItemById) => mapDatasToFacet([Highlight, \"item\"], [\n    //\n    getItemById,\n    getm([Highlight, \"id\"]),\n], (itemById, id) => {\n    return itemById[id];\n});\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { mapDataToFacet, data, operation } from \"skandha\";\nimport { host } from \"aspiration\";\nexport class Filtering {\n    constructor() {\n        Object.defineProperty(this, \"isEnabled\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n        Object.defineProperty(this, \"filter\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: () => []\n        });\n        Object.defineProperty(this, \"inputItems\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    get filteredItems() {\n        return this.isEnabled ? this.filter(this.inputItems) : this.inputItems;\n    }\n    apply(filter) {\n        return (cbs) => {\n            this.filter = filter;\n            this.setEnabled(true);\n        };\n    }\n    setEnabled(flag) {\n        return (cbs) => {\n            this.isEnabled = flag;\n        };\n    }\n}\n__decorate([\n    data\n], Filtering.prototype, \"isEnabled\", void 0);\n__decorate([\n    data\n], Filtering.prototype, \"filter\", void 0);\n__decorate([\n    data\n], Filtering.prototype, \"inputItems\", void 0);\n__decorate([\n    data\n], Filtering.prototype, \"filteredItems\", null);\n__decorate([\n    operation,\n    host\n], Filtering.prototype, \"apply\", null);\n__decorate([\n    operation,\n    host\n], Filtering.prototype, \"setEnabled\", null);\nexport const filteringUsesInputItems = (getItems, transform) => mapDataToFacet([Filtering, \"inputItems\"], getItems, transform);\n","export const topOfTheList = \"<topOfTheList>\";\nexport function getPreview(items, targetItemId, isBefore, payload) {\n    const maybeTargetItemId = targetItemId == topOfTheList ? undefined : targetItemId;\n    return !payload.length\n        ? items\n        : items.reduce((acc, item) => {\n            if (item.id === maybeTargetItemId && isBefore) {\n                acc.push(...payload);\n            }\n            if (!payload.find((x) => x.id === item.id)) {\n                acc.push(item);\n            }\n            if (item.id === maybeTargetItemId && !isBefore) {\n                acc.push(...payload);\n            }\n            return acc;\n        }, maybeTargetItemId ? [] : [...payload]);\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { host } from \"aspiration\";\nimport { input, mapDataToFacet, operation, output } from \"skandha\";\nimport { getPreview } from \"./lib/getPreview\";\nexport class Insertion {\n    constructor() {\n        Object.defineProperty(this, \"inputItems\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"preview\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    insertItems(drag) {\n        return (cbs) => {\n            if (this.inputItems) {\n                const preview = getPreview(this.inputItems, drag.targetItemId, drag.isBefore, drag.payload);\n                cbs.insertItems(preview);\n            }\n        };\n    }\n}\n__decorate([\n    input\n], Insertion.prototype, \"inputItems\", void 0);\n__decorate([\n    output\n], Insertion.prototype, \"preview\", void 0);\n__decorate([\n    operation,\n    host\n], Insertion.prototype, \"insertItems\", null);\nexport const insertionUsesInputItems = (getItems, transform) => mapDataToFacet([Insertion, \"inputItems\"], getItems, transform);\n","import { getf, getc } from \"skandha\";\nimport { Highlight } from \"../Highlight\";\nexport function highlightFollowsSelection(facet, { itemId, isShift, isCtrl }) {\n    const ctr = getc(facet);\n    if (!isCtrl && !isShift) {\n        getf(Highlight, ctr).highlightItem(itemId);\n    }\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { operation, data } from \"skandha\";\nimport { host, maybe } from \"aspiration\";\nexport class Addition {\n    constructor() {\n        Object.defineProperty(this, \"item\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n        Object.defineProperty(this, \"parentId\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: void 0\n        });\n    }\n    add(values) {\n        return (cbs) => {\n            maybe(cbs.storeLocation).bind(cbs)();\n            this.item = cbs.createItem();\n            maybe(cbs.highlightNewItem).bind(cbs)();\n        };\n    }\n    confirm() {\n        return (cbs) => {\n            cbs.confirm();\n            this._reset();\n        };\n    }\n    cancel() {\n        return (cbs) => {\n            this._reset();\n            maybe(cbs.restoreLocation).bind(cbs)();\n        };\n    }\n    _reset() {\n        this.item = undefined;\n        this.parentId = undefined;\n    }\n}\n__decorate([\n    data\n], Addition.prototype, \"item\", void 0);\n__decorate([\n    data\n], Addition.prototype, \"parentId\", void 0);\n__decorate([\n    operation,\n    host\n], Addition.prototype, \"add\", null);\n__decorate([\n    operation,\n    host\n], Addition.prototype, \"confirm\", null);\n__decorate([\n    operation,\n    host\n], Addition.prototype, \"cancel\", null);\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { data, operation } from \"skandha\";\nimport { host, maybe } from \"aspiration\";\nexport class Editing {\n    constructor() {\n        Object.defineProperty(this, \"isEditing\", {\n            enumerable: true,\n            configurable: true,\n            writable: true,\n            value: false\n        });\n    }\n    save(values) {\n        return (cbs) => {\n            cbs.saveItem();\n            this.isEditing = false;\n            maybe(cbs.refreshView).bind(cbs)();\n        };\n    }\n    cancel() {\n        return (cbs) => {\n            this.isEditing = false;\n        };\n    }\n    enable() {\n        return (cbs) => {\n            this.isEditing = true;\n        };\n    }\n}\n__decorate([\n    data\n], Editing.prototype, \"isEditing\", void 0);\n__decorate([\n    operation,\n    host\n], Editing.prototype, \"save\", null);\n__decorate([\n    operation,\n    host\n], Editing.prototype, \"cancel\", null);\n__decorate([\n    operation,\n    host\n], Editing.prototype, \"enable\", null);\n","import { size } from 'lodash/fp';\n\nexport const randomElement = (items: Array<any>) =>\n  items[Math.floor(Math.random() * size(items))];\n","import {\n  always,\n  concat,\n  size,\n  flow,\n  times,\n  constant,\n  take,\n  takeRight,\n} from 'lodash/fp';\nimport { ChordT } from 'src/voicings/types';\n\nexport const invertChord = (chord: ChordT, pos: number) => {\n  function rotate(arr: ChordT) {\n    const maxNote = arr[arr.length - 1];\n    let first = take(1, arr);\n    const last = takeRight(size(arr) - 1, arr);\n    while (first[0] <= maxNote) {\n      first[0] += 12;\n    }\n    return concat(last, first);\n  }\n\n  function rotateBack(arr: ChordT) {\n    const minNote = arr[0];\n    let last = takeRight(1, arr);\n    const first = take(size(arr) - 1, arr);\n    while (last[0] >= minNote) {\n      last[0] -= 12;\n    }\n    return concat(last, first);\n  }\n\n  const result =\n    pos === 0\n      ? chord\n      : pos > 0\n      ? flow(always(chord), ...times(constant(rotate), pos))()\n      : flow(always(chord), ...times(constant(rotateBack), Math.abs(pos)))();\n  return result;\n};\n\nexport const getInversionRange = (chord: ChordT) => {\n  const topC = 48;\n  let minInversion = 0;\n  let maxInversion = 0;\n  const l = chord.length;\n\n  while (invertChord(chord, maxInversion + 1)[l - 1] < topC) {\n    maxInversion += 1;\n  }\n\n  while (invertChord(chord, minInversion - 1)[0] >= 0) {\n    minInversion -= 1;\n  }\n\n  return [minInversion, maxInversion];\n};\n","import { add, always, map, flow } from 'lodash/fp';\n\nimport { octaveRootNoteValue, clefOffsets } from 'src/keyboard/keyConstants';\nimport { VoicingT } from 'src/voicings/types';\n\nexport const voicingToChord = (\n  voicing: VoicingT,\n  clef: string,\n  octaveIndex: number\n) => {\n  let rootNoteValue = octaveRootNoteValue(octaveIndex);\n  const keyOffset = clefOffsets[clef];\n\n  const result = flow(\n    //\n    always(voicing.chord),\n    map(add(rootNoteValue + keyOffset))\n  )();\n  return result;\n};\n","import { range, sumBy } from 'lodash/fp';\nimport { randomElement } from 'src/utils/random';\nimport { ClefT } from 'src/keyboard/types';\nimport { GroupT } from 'src/groups/types';\nimport { VoicingT } from 'src/voicings/types';\nimport { getInversionRange } from 'src/voicings/utils/invertChord';\nimport { QueryT } from 'src/quiz/types';\nimport { voicingToChord } from 'src/voicings/utils/voicingToChord';\nimport { mathMod } from 'src/utils/mathMod';\n\nconst getRandomInversion = (voicing: VoicingT, clef: ClefT) => {\n  const L = voicing.chord.length;\n\n  const [minInversion, maxInversion] = getInversionRange(\n    voicingToChord(voicing, clef, 1)\n  );\n  const inversionRange = range(minInversion, maxInversion + 1).filter((x) => {\n    return voicing.inversions[mathMod(x, L)] !== false;\n  });\n  if (inversionRange.length === 0) {\n    return 0;\n  }\n  let inversion = randomElement(inversionRange);\n\n  // Try to bring inversion closer to zero using steps of voicing.chord.length inversions\n  // (which means its the same inversion, just at a different place on the keyboard)\n  while (\n    inversion + L <= maxInversion &&\n    Math.abs(inversion) > Math.abs(inversion + L)\n  ) {\n    inversion += L;\n  }\n  while (\n    inversion - L >= minInversion &&\n    Math.abs(inversion) > Math.abs(inversion - L)\n  ) {\n    inversion -= L;\n  }\n  return inversion;\n};\n\nexport const createQuery = (clefs: ClefT[], groups: GroupT[]): QueryT => {\n  const clef = randomElement(clefs);\n  const nrVoicings = sumBy((x: GroupT) => x.voicings.length)(groups);\n  const voicingIdx = Math.floor(Math.random() * nrVoicings);\n\n  let groupIdx = 0;\n  let count = groups[0].voicings.length;\n  while (voicingIdx >= count) {\n    groupIdx += 1;\n    count += groups[groupIdx].voicings.length;\n  }\n\n  const group = groups[groupIdx];\n  const voicing = group.voicings[voicingIdx - (count - group.voicings.length)];\n  const inversion = getRandomInversion(voicing, clef);\n\n  return {\n    clef,\n    group,\n    voicing,\n    inversion,\n  };\n};\n","import { ClefT } from 'src/keyboard/types';\nimport { GroupT } from 'src/groups/types';\nimport { input } from 'skandha';\n\nexport class Inputs {\n  @input groups: Array<GroupT> = [];\n  @input clefs: Array<ClefT> = [];\n}\n","import { computed } from 'mobx';\nimport { GroupT, GroupByIdT } from 'src/groups/types';\nimport { listToItemById } from 'src/utils/ids';\nimport { output } from 'skandha';\nimport { ClefT } from 'src/keyboard/types';\n\nexport class Outputs {\n  @output clefsDisplay: Array<ClefT> = [];\n  @output groupsDisplay: Array<GroupT> = [];\n\n  @computed get groupById(): GroupByIdT {\n    return listToItemById(this.groupsDisplay);\n  }\n}\n","import { setCallbacks } from 'aspiration';\nimport { action, observable, makeObservable } from 'mobx';\nimport {\n  addCleanUpFunctionToCtr,\n  facet,\n  getm,\n  cleanUpCtr,\n  mapDataToFacet,\n  installPolicies,\n  registerFacets,\n  ClassMemberT as CMT,\n} from 'skandha';\nimport { makeCtrObservable } from 'skandha-mobx';\nimport { getIds } from 'src/utils/ids';\nimport * as Facets from 'skandha-facets';\nimport * as Policies from 'src/quiz/QuizState/policies';\nimport * as FacetPolicies from 'skandha-facets/policies';\nimport {\n  Selection,\n  SelectionCbs,\n  handleSelectItem,\n} from 'skandha-facets/Selection';\nimport { Highlight, HighlightCbs } from 'skandha-facets/Highlight';\nimport { createQuery } from 'src/quiz/utils/createQuery';\nimport { PreselectionStore } from 'src/keyboard/PreselectionStore';\n\nimport { QueryT } from 'src/quiz/types';\nimport { GroupsStore } from 'src/groups/GroupsStore';\nimport { VoicingStore } from 'src/voicings/VoicingStore';\nimport { ClefStore } from 'src/keyboard/ClefStore';\nimport { Inputs } from 'src/quiz/QuizState/facets/Inputs';\nimport { Outputs } from 'src/quiz/QuizState/facets/Outputs';\nimport { ClefT } from 'src/keyboard/types';\nimport { GroupT } from 'src/groups/types';\n\ntype PropsT = {\n  clefStore: ClefStore;\n  groupsStore: GroupsStore;\n  voicingStore: VoicingStore;\n  preselectionStore: PreselectionStore;\n};\n\nexport class QuizState {\n  props: PropsT;\n  @observable query?: QueryT;\n  @observable nextQuery?: QueryT;\n\n  @facet inputs = new Inputs();\n  @facet outputs = new Outputs();\n\n  clefs = {\n    selection: new Selection(),\n    highlight: new Highlight(),\n  };\n  groups = {\n    selection: new Selection(),\n    highlight: new Highlight(),\n  };\n\n  _setClefsCallbacks(props: PropsT) {\n    const ctr = this.clefs;\n    setCallbacks(ctr.selection, {\n      selectItem: {\n        selectItem(this: SelectionCbs['selectItem']) {\n          handleSelectItem(ctr.selection, this.selectionParams);\n          FacetPolicies.highlightFollowsSelection(\n            ctr.selection,\n            this.selectionParams\n          );\n        },\n      },\n    } as SelectionCbs);\n    setCallbacks(ctr.highlight, {} as HighlightCbs);\n  }\n\n  _setGroupsCallbacks(props: PropsT) {\n    const ctr = this.groups;\n    setCallbacks(ctr.selection, {\n      selectItem: {\n        selectItem(this: SelectionCbs['selectItem']) {\n          handleSelectItem(ctr.selection, this.selectionParams);\n          FacetPolicies.highlightFollowsSelection(\n            ctr.selection,\n            this.selectionParams\n          );\n        },\n      },\n    } as SelectionCbs);\n    setCallbacks(ctr.highlight, {} as HighlightCbs);\n  }\n\n  _applyClefsPolicies(props: PropsT) {\n    const Inputs_items = [Inputs, 'clefs', this] as CMT;\n    const Outputs_display = [Outputs, 'clefsDisplay', this] as CMT;\n\n    const policies = [\n      mapDataToFacet(Outputs_display, getm(Inputs_items)),\n      // selection\n      Facets.selectionUsesSelectableIds(getm(Outputs_display)),\n    ];\n\n    installPolicies(policies, this.clefs);\n  }\n\n  _applyGroupsPolicies(props: PropsT) {\n    const Inputs_items = [Inputs, 'groups', this] as CMT;\n    const Outputs_display = [Outputs, 'groupsDisplay', this] as CMT;\n    const Outputs_itemById = [Outputs, 'groupById', this] as CMT;\n\n    const policies = [\n      mapDataToFacet(Outputs_display, getm(Inputs_items)),\n      // selection\n      Facets.selectionUsesSelectableIds(getm(Outputs_display), getIds),\n      Facets.selectionUsesItemLookUpTable(getm(Outputs_itemById)),\n      // highlight\n      Facets.highlightUsesItemLookUpTable(getm(Outputs_itemById)),\n    ];\n\n    installPolicies(policies, this.groups);\n  }\n\n  destroy() {\n    cleanUpCtr(this.clefs);\n    cleanUpCtr(this.groups);\n  }\n\n  constructor(props: PropsT) {\n    this.props = props;\n\n    registerFacets(this, {});\n    makeObservable(this);\n\n    registerFacets(this.clefs, { name: 'Clefs' });\n    this._setClefsCallbacks(props);\n    this._applyClefsPolicies(props);\n    makeCtrObservable(this.clefs);\n\n    registerFacets(this.groups, { name: 'Groups' });\n    this._setGroupsCallbacks(props);\n    this._applyGroupsPolicies(props);\n    makeCtrObservable(this.groups);\n\n    const cuf = Policies.selectClefBasedOnPreselection()(this);\n    addCleanUpFunctionToCtr(this.clefs, cuf);\n  }\n\n  @action setClefs(clefs: ClefT[]) {\n    this.inputs.clefs = clefs;\n    this.clefs.selection.ids = clefs;\n  }\n\n  @action setGroups(groups: GroupT[]) {\n    this.inputs.groups = groups;\n    this.groups.selection.ids = getIds(groups);\n  }\n\n  @action pickRandomChord() {\n    this.query =\n      this.nextQuery ??\n      createQuery(this.clefs.selection.ids, this.groups.selection.items ?? []);\n\n    this.nextQuery = createQuery(\n      this.clefs.selection.ids,\n      this.groups.selection.items ?? []\n    );\n\n    if (this.query) {\n      this.props.clefStore.setClef(this.query.clef);\n      this.props.voicingStore.setVoicing(this.query.voicing);\n      this.props.voicingStore.setInversion(this.query.inversion);\n    }\n  }\n}\n","import { EventT } from 'src/utils/types';\nimport { QuizState } from 'src/quiz/QuizState';\n\nexport const selectClefBasedOnPreselection = () => (quizState: QuizState) => {\n  const handler = (event: EventT) => {\n    if (quizState.query && event.topic === 'PreselectionStore.selectClef') {\n      quizState.query.clef =\n        event.details.clefLetter +\n        (event.details.isSharpening\n          ? '#'\n          : event.details.isFlattening\n          ? 'b'\n          : '');\n      quizState.props.clefStore.setClef(quizState.query.clef);\n    }\n  };\n\n  quizState.props.preselectionStore.signal.add(handler as any);\n  return () => quizState.props.preselectionStore.signal.remove(handler);\n};\n","export const voicingGroups = [\n  {\n    id: 'minor',\n    name: 'minor',\n    voicings: [\n      {\n        id: 'Min6+9',\n        name: 'Min6+9',\n        chord: ['flat3', 'fifth', 'ninth', 'thirteenth'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: 'Min7+9',\n        name: 'Min7+9',\n        chord: ['flat3', 'fifth', 'flat7', 'ninth'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: '+9',\n        name: '+9',\n        chord: ['flat3', 'flat5', 'flat7', 'ninth'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: 'MinMaj+9',\n        name: 'MinMaj+9',\n        chord: ['flat3', 'fifth', 'seventh', 'ninth'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: 'Min6',\n        name: 'Min6',\n        chord: ['flat3', 'fifth', 'thirteenth'],\n        inversions: [true, true, true],\n      },\n      {\n        id: 'Min7',\n        name: 'Min7',\n        chord: ['flat3', 'fifth', 'flat7'],\n        inversions: [true, true, true],\n      },\n      {\n        id: '',\n        name: '',\n        chord: ['flat3', 'flat5', 'flat7'],\n        inversions: [true, true, true],\n      },\n      {\n        id: 'Min',\n        name: 'Min',\n        chord: ['flat3', 'fifth'],\n        inversions: [true, true],\n      },\n      {\n        id: 'MinMaj',\n        name: 'MinMaj',\n        chord: ['flat3', 'fifth', 'seventh'],\n        inversions: [true, true, true],\n      },\n    ],\n  },\n  {\n    id: 'fourths',\n    name: 'fourths',\n    voicings: [\n      {\n        id: 'SoWhat',\n        name: 'SoWhat',\n        chord: ['root', 'fourth', 'flat7', 'flat3', 'fifth'],\n        inversions: [false, true, false, false, false, false],\n      },\n    ],\n  },\n  {\n    id: 'major',\n    name: 'major',\n    voicings: [\n      {\n        id: 'Maj6+9',\n        name: 'Maj6+9',\n        chord: ['third', 'sixth', 'ninth'],\n        inversions: [true, true, true],\n      },\n      {\n        id: 'Maj7+9',\n        name: 'Maj7+9',\n        chord: ['third', 'fifth', 'seventh', 'ninth'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: 'Maj6',\n        name: 'Maj6',\n        chord: ['third', 'sixth'],\n        inversions: [true, true],\n      },\n      {\n        id: 'Maj7',\n        name: 'Maj7',\n        chord: ['third', 'fifth', 'seventh'],\n        inversions: [true, true, true],\n      },\n      {\n        id: 'Maj',\n        name: 'Maj',\n        chord: ['third', 'fifth'],\n        inversions: [true, true],\n      },\n    ],\n  },\n  {\n    id: 'dominant',\n    name: 'dominant',\n    voicings: [\n      { id: '7+13', name: '7+13', chord: ['third', 'flat7', 'thirteenth'] },\n      {\n        id: '7+9',\n        name: '7+9',\n        chord: ['third', 'fifth', 'flat7', 'ninth'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: '7+b13',\n        name: '7+b13',\n        chord: ['third', 'flat7', 'flat13'],\n        inversions: [true, true, true],\n      },\n      {\n        id: '7+9+b13',\n        name: '7+9+b13',\n        chord: ['third', 'flat7', 'ninth', 'flat13'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: '7+b5',\n        name: '7+b5',\n        chord: ['third', 'flat5', 'flat7'],\n        inversions: [true, true, true],\n      },\n      {\n        id: '7+b5+b13',\n        name: '7+b5+b13',\n        chord: ['third', 'flat5', 'flat7', 'flat13'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: '7+b9',\n        name: '7+b9',\n        chord: ['third', 'fifth', 'flat7', 'flat9'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: '7+b9+13',\n        name: '7+b9+13',\n        chord: ['third', 'thirteenth', 'flat7', 'flat9'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: '7+b9+b13',\n        name: '7+b9+b13',\n        chord: ['third', 'flat13', 'flat7', 'flat9'],\n        inversions: [true, true, true, true],\n      },\n      {\n        id: '7',\n        name: '7',\n        chord: ['third', 'fifth', 'flat7'],\n        inversions: [true, true, true],\n      },\n    ],\n  },\n];\n","import * as React from 'react';\nimport { action, reaction } from 'mobx';\n\nimport { QuizState } from 'src/quiz/QuizState';\nimport { CtrProvider } from 'react-default-props-context';\nimport { useStore } from 'src/app/components';\nimport { voicingGroups } from 'src/voicings/voicingGroups';\nimport { clefs } from 'src/keyboard/keyConstants';\nimport { parseVoicingGroups } from 'src/voicings/parse';\n\ntype PropsT = React.PropsWithChildren<{}>;\n\n// Note: don't observe this with MobX\nexport const QuizStateProvider: React.FC<PropsT> = (props: PropsT) => {\n  const {\n    groupsStore,\n    clefStore,\n    voicingStore,\n    preselectionStore,\n  } = useStore();\n  const groups = parseVoicingGroups(voicingGroups);\n\n  const createState = action(() => {\n    const state = new QuizState({\n      groupsStore,\n      clefStore,\n      voicingStore,\n      preselectionStore,\n    });\n    state.setClefs(clefs);\n    state.setGroups(groups);\n    return state;\n  });\n\n  const updateState = (state: QuizState) => {\n    reaction(\n      () => ({}),\n      (inputs) => {},\n      {\n        fireImmediately: true,\n      }\n    );\n  };\n\n  const getDefaultProps = (state: QuizState) => {\n    return {\n      quizState: () => state,\n      clefs: () => state.outputs.clefsDisplay,\n      clefsSelection: () => state.clefs.selection,\n      clefsHighlight: () => state.clefs.highlight,\n      clef: () => state.clefs.highlight.item,\n      groups: () => state.outputs.groupsDisplay,\n      groupsSelection: () => state.groups.selection,\n      groupsHighlight: () => state.groups.highlight,\n      group: () => state.groups.highlight.item,\n    };\n  };\n\n  return (\n    <CtrProvider\n      createCtr={createState}\n      updateCtr={updateState}\n      destroyCtr={(state: QuizState) => state.destroy()}\n      getDefaultProps={getDefaultProps}\n    >\n      {props.children}\n    </CtrProvider>\n  );\n};\n","import React from 'react';\nimport { Router, Switch, Route } from 'react-router-dom';\nimport { observer } from 'mobx-react-lite';\nimport { createBrowserHistory } from 'history';\nimport { QuizView } from 'src/quiz/components';\nimport { QuizStateProvider } from 'src/quiz/components';\n\ntype PropsT = {};\n\nexport const history = createBrowserHistory();\n\nexport const UrlRouter: React.FC<PropsT> = observer((props: PropsT) => {\n  return (\n    <Router history={history}>\n      <Switch>\n        <Route path=\"\">\n          <QuizStateProvider>\n            <QuizView />\n          </QuizStateProvider>\n        </Route>\n      </Switch>\n    </Router>\n  );\n});\n","import React from 'react';\n\nimport './App.scss';\nimport { UrlRouter } from 'src/app/components/UrlRouter';\n\nexport function App() {\n  return (\n    <div className=\"App w-screen\">\n      <header className=\"App__Header\">\n        <UrlRouter />\n      </header>\n    </div>\n  );\n}\n","import { GroupByIdT } from 'src/groups/types';\nimport { observable, makeObservable } from 'mobx';\n\nexport class GroupsStore {\n  @observable groupById: GroupByIdT = {};\n\n  constructor() {\n    makeObservable(this);\n  }\n\n  loadGroups() {}\n}\n","import { makeObservable, observable, action } from 'mobx';\nimport { Signal } from 'micro-signals';\n\nexport class PreselectionStore {\n  signal = new Signal();\n  clefLetter?: string = undefined;\n  isSharpening?: boolean = undefined;\n  isFlattening?: boolean = undefined;\n\n  constructor() {\n    makeObservable(this, {\n      clefLetter: observable,\n      isSharpening: observable,\n      isFlattening: observable,\n      setClefLetter: action,\n      setIsSharpening: action,\n      setIsFlattening: action,\n      reset: action,\n    });\n  }\n\n  setClefLetter = (x?: string) => (this.clefLetter = x);\n  setIsSharpening = (x?: boolean) => (this.isSharpening = x);\n  setIsFlattening = (x?: boolean) => (this.isFlattening = x);\n\n  reset = () => {\n    if (this.clefLetter) {\n      this.signal.dispatch({\n        topic: 'PreselectionStore.selectClef',\n        details: {\n          clefLetter: this.clefLetter,\n          isSharpening: this.isSharpening,\n          isFlattening: this.isFlattening,\n        },\n      });\n    }\n    this.setIsFlattening(false);\n    this.setIsSharpening(false);\n    this.setClefLetter(undefined);\n  };\n}\n","import { clamp, size } from 'lodash/fp';\nimport { action, computed, makeObservable, observable } from 'mobx';\nimport { invertChord } from 'src/voicings/utils/invertChord';\nimport { voicingToChord } from 'src/voicings/utils/voicingToChord';\nimport { VoicingT } from 'src/voicings/types';\nimport { getInversionRange } from 'src/voicings/utils/invertChord';\nimport { parseVoicing } from 'src/voicings/parse';\n\nconst cScale = parseVoicing({\n  id: 'Chromatic',\n  name: 'Chromatic',\n  chord: [\n    'root',\n    'flat9',\n    'ninth',\n    'flat3',\n    'third',\n    'fourth',\n    'flat5',\n    'fifth',\n    'flat6',\n    'sixth',\n    'flat7',\n    'seventh',\n  ],\n});\n\nexport class VoicingStore {\n  clef: string = 'C';\n  inversion: number = 0;\n  voicing: VoicingT = cScale;\n\n  constructor() {\n    makeObservable(this, {\n      clef: observable,\n      inversion: observable,\n      voicing: observable,\n      chord: computed,\n      nrOfVoices: computed,\n      inversionRange: computed,\n      setInversion: action,\n      setVoicing: action,\n    });\n  }\n\n  setInversion = (x: number) => {\n    this.inversion = clamp(\n      this.inversionRange[0],\n      this.inversionRange[1]\n    )(x) as any;\n  };\n\n  setVoicing = (voicing: VoicingT) => {\n    this.voicing = voicing;\n  };\n\n  get inversionRange() {\n    return getInversionRange(voicingToChord(this.voicing, this.clef, 1));\n  }\n\n  get nrOfVoices() {\n    return size(this.voicing.chord);\n  }\n\n  get chord() {\n    return this.clef\n      ? invertChord(voicingToChord(this.voicing, this.clef, 1), this.inversion)\n      : undefined;\n  }\n}\n","import { action, computed, makeObservable, observable } from 'mobx';\n\nimport { clefC } from 'src/keyboard/keyConstants';\nimport { ClefT } from 'src/keyboard/types';\n\nexport class ClefStore {\n  clefLetter = clefC;\n  clefSharp = false;\n  clefFlat = false;\n\n  constructor() {\n    makeObservable(this, {\n      clefLetter: observable,\n      clefSharp: observable,\n      clefFlat: observable,\n      setClefLetter: action,\n      setClefSharp: action,\n      setClefFlat: action,\n      clef: computed,\n    });\n  }\n\n  setClefLetter = (clefLetter: string) => {\n    this.clefLetter = clefLetter;\n  };\n\n  setClefSharp = (x: boolean) => {\n    this.clefSharp = x;\n    if (x) this.clefFlat = false;\n  };\n\n  setClefFlat = (x: boolean) => {\n    this.clefFlat = x;\n    if (x) this.clefSharp = false;\n  };\n\n  get clef() {\n    return this.clefLetter + (this.clefSharp ? '#' : this.clefFlat ? 'b' : '');\n  }\n\n  setClef(x: ClefT) {\n    const clefLetter = x[0];\n    this.setClefLetter(clefLetter);\n    const modulate = x[1];\n    this.setClefFlat(modulate == 'b');\n    this.setClefSharp(modulate == '#');\n  }\n}\n","import React from 'react';\nimport { AppStore } from 'src/app/AppStore';\n\nconst appStore = new AppStore();\n\nexport const StoreContext = React.createContext<AppStore>(appStore);\n\nexport const StoreProvider: React.FC = ({ children }) => {\n  return (\n    <StoreContext.Provider value={appStore}>\n      {children}\n    </StoreContext.Provider>\n  );\n};","import { observable, makeObservable } from 'mobx';\nimport { GroupsStore } from 'src/groups/GroupsStore';\nimport { PreselectionStore } from 'src/keyboard/PreselectionStore';\nimport { VoicingStore } from 'src/voicings/VoicingStore';\nimport { ClefStore } from 'src/keyboard/ClefStore';\nimport * as Policies from 'src/app/policies';\n\nexport class AppStore {\n  @observable groupsStore: GroupsStore;\n  voicingStore = new VoicingStore();\n  clefStore = new ClefStore();\n  preselectionStore = new PreselectionStore();\n\n  constructor() {\n    makeObservable(this, {\n      voicingStore: observable,\n      clefStore: observable,\n      preselectionStore: observable,\n    });\n    this.groupsStore = new GroupsStore();\n    this.applyPolicies();\n  }\n\n  applyPolicies() {\n    Policies.voicingStoreUsesSelectedClef()(this);\n  }\n}\n","import { reaction } from 'mobx';\nimport { AppStore } from 'src/app/AppStore';\n\nexport const voicingStoreUsesSelectedClef = () => (appStore: AppStore) => {\n  reaction(\n    () => appStore.clefStore.clef,\n    (clef) => {\n      appStore.voicingStore.clef = clef;\n    },\n    { fireImmediately: true }\n  );\n};\n","import React from 'react';\nimport { StoreContext } from 'src/app/components/StoreProvider';\n\nexport const useStore = () => {\n  const store = React.useContext(StoreContext);\n  if (!store) {\n    throw new Error('useStore must be used within a StoreProvider.');\n  }\n  return store;\n};","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'antd/dist/antd.css';\nimport { App } from 'src/app/components';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}